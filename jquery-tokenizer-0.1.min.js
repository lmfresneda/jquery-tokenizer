!function(e){"use strict";e.tokenizer=e.tk={version:"0.1"},e.fn.tokenizer=e.fn.tk=function(){var t=this,n=13,r=46,a=8,o=function(e){for(var t=e.concat(),n=0;n<t.length;++n)for(var r=n+1;r<t.length;++r)t[n]===t[r]&&t.splice(r--,1);return t},i=function(t){var n=e("<div></div>").addClass("tokenizer-values").width(t.width()-7);return n},s=function(){e(".tokenizer-token").remove()},u=function(t){t.each(function(){e(this).remove()})},l=function(t){var n=e("<span></span>").addClass("tokenizer-token").text(t).attr("data-value",t).prepend(e("<span></span>").addClass("tokenizer-token-close").text("x"));return n.on("click",function(){e(this).toggleClass("tokenizer-token-active")}),n.find("span").on("click",function(){u(n)}),n},c=function(t){var n=l(e.fn.tokenizer.defaults.text.max_all);n.addClass("tokenizer-token-max"),n.removeAttr("data-value"),t.append(n),setTimeout(function(){u(n)},1500)},d=function(){var t=[];return e(".tokenizer-token[data-value]").each(function(){t.push(e(this).attr("data-value"))}),t},f=function(e){for(var t="s*[",n=0;n<e.length;n++)t+=e[n];return t+="]s*",new RegExp(t)},v=function(t,n){s(),e.each(t,function(t,r){r=e.trim(r),n.append(l(r))})},p={get:function(e){if(e.length>1)throw new Error("Número de argumentos inválidos, se requiere ('option') solamente");return d()},set:function(r){var a;if(2!=r.length)throw new Error("Número de argumentos inválidos, se requiere ('option', String|Array)");if("string"==typeof r[1])a=r[1];else{if(!(r[1]instanceof Array))throw new Error("Segundo parámetro inválido, se requiere ('option', String|Array)");a=r[1].join(e.fn.tokenizer.defaults.separators[0])}return t.val(a),t.trigger(e.Event("keypress",{keyCode:n})),t},del:function(n){if(2!=n.length)throw new Error("Número de argumentos inválidos, se requiere ('option', String)");if("string"!=typeof n[1])throw new Error("Segundo parámetro inválido, se requiere ('option', String)");return e(".tokenizer-token[data-value='"+n[1]+"']").remove(),t}};if(!arguments.length||e.isPlainObject(arguments[0])){var g=arguments.length?arguments[0]:{};return e(document).on("keydown",function(t){(t.keyCode==r||t.keyCode==a)&&u(e(".tokenizer-token-active"))}),g=e.extend({},e.fn.tokenizer.defaults,g),t.each(function(){var t=e(this);console.log(t);var r=e("<div></div>").addClass("tokenizer-wrapper").width(t.width());t.wrap(r);var a=i(t);t.parent().append(a),t.css("margin-bottom","0px"),t.off().on("keypress",function(r){if(r.keyCode==n){if(r.preventDefault(),""!=e.trim(t.val())){var i=f(g.separators),s=t.val().split(i);g.max_input>0&&(s=s.splice(0,g.max_input));var s=d().concat(s),u=!1;if(g.max_all>0){var l=s.length;s=s.splice(0,g.max_all),l!=s.length&&(u=!0)}g.repeat||(s=o(s)),v(s,a),u&&c(a)}t.val("")}})})}switch(arguments[0]){case"get":case"val":return p.get(arguments);case"set":case"input":return p.set(arguments);case"del":case"delete":case"rm":case"remove":return p.del(arguments);default:throw new Error("Opción '"+arguments[0]+"' no válida")}},e.fn.tokenizer.defaults=e.fn.tk.defaults={separators:[",",";"],repeat:!1,max_all:0,max_input:0,text:{max_all:"Máximo alcanzado"}}}(jQuery);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS10b2tlbml6ZXItMC4xLmpzIl0sIm5hbWVzIjpbIiQiLCJ0b2tlbml6ZXIiLCJ0ayIsInZlcnNpb24iLCJmbiIsIiR0aGlzIiwidGhpcyIsIktFWV9DT0RFX0VOVEVSIiwiS0VZX0NPREVfU1VQUiIsIktFWV9DT0RFX0RFTCIsIl91bmlxdWVBcnJheSIsImFycmF5IiwiYSIsImNvbmNhdCIsImkiLCJsZW5ndGgiLCJqIiwic3BsaWNlIiwiX2dldFdyYXBwZXJWYWx1ZXMiLCIkaW5wdXQiLCIkd3JhcHBlclZhbHVlcyIsImFkZENsYXNzIiwid2lkdGgiLCJfcmVtb3ZlQWxsVG9rZW4iLCJyZW1vdmUiLCJfcmVtb3ZlVG9rZW4iLCIkdG9rZW5zIiwiZWFjaCIsIl9nZXRUb2tlbiIsInZhbHVlIiwiJHRva2VuIiwidGV4dCIsImF0dHIiLCJwcmVwZW5kIiwib24iLCJ0b2dnbGVDbGFzcyIsImZpbmQiLCJfc2hvd01heEFsbCIsImRlZmF1bHRzIiwibWF4X2FsbCIsInJlbW92ZUF0dHIiLCJhcHBlbmQiLCJzZXRUaW1lb3V0IiwiX2dldFZhbHVlcyIsInRva2VucyIsInB1c2giLCJfYnVpbGRSZWdFeHAiLCJzZXBhcmF0b3JzIiwic3RyUmVnIiwiUmVnRXhwIiwiX3ByaW50VG9rZW5zIiwiayIsImVsIiwidHJpbSIsIl9vcGVyYXRpb25zIiwiZ2V0IiwiYXJncyIsIkVycm9yIiwic2V0Iiwic3RyIiwiQXJyYXkiLCJqb2luIiwidmFsIiwidHJpZ2dlciIsIkV2ZW50Iiwia2V5Q29kZSIsImRlbCIsImFyZ3VtZW50cyIsImlzUGxhaW5PYmplY3QiLCJzZXR0aW5ncyIsImRvY3VtZW50IiwiZSIsImV4dGVuZCIsImNvbnNvbGUiLCJsb2ciLCIkd3JhcHBlciIsIndyYXAiLCJwYXJlbnQiLCJjc3MiLCJvZmYiLCJwcmV2ZW50RGVmYXVsdCIsInJlZyIsInNwbGl0IiwibWF4X2lucHV0Iiwic2hvd01heCIsImxlbiIsInJlcGVhdCIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IkNBUUMsU0FBV0EsR0FDUixZQUVBQSxHQUFFQyxVQUFZRCxFQUFFRSxJQUNaQyxRQUFTLE9BR2JILEVBQUVJLEdBQUdILFVBQVlELEVBQUVJLEdBQUdGLEdBQUssV0FDdkIsR0FBSUcsR0FBUUMsS0FDUkMsRUFBaUIsR0FDakJDLEVBQWdCLEdBQ2hCQyxFQUFlLEVBRWZDLEVBQWUsU0FBVUMsR0FFekIsSUFBSyxHQUREQyxHQUFJRCxFQUFNRSxTQUNMQyxFQUFJLEVBQUdBLEVBQUlGLEVBQUVHLFNBQVVELEVBQzVCLElBQUssR0FBSUUsR0FBSUYsRUFBSSxFQUFHRSxFQUFJSixFQUFFRyxTQUFVQyxFQUM1QkosRUFBRUUsS0FBT0YsRUFBRUksSUFDWEosRUFBRUssT0FBT0QsSUFBSyxFQUcxQixPQUFPSixJQUVQTSxFQUFvQixTQUFVQyxHQUM5QixHQUFJQyxHQUFpQnBCLEVBQUUsZUFDTnFCLFNBQVMsb0JBQ1RDLE1BQU1ILEVBQU9HLFFBQVUsRUFDeEMsT0FBT0YsSUFFUEcsRUFBa0IsV0FDbEJ2QixFQUFFLG9CQUFvQndCLFVBRXRCQyxFQUFlLFNBQVNDLEdBQ3hCQSxFQUFRQyxLQUFLLFdBQ1QzQixFQUFFTSxNQUFNa0IsWUFHWkksRUFBWSxTQUFVQyxHQUN0QixHQUFJQyxHQUFTOUIsRUFBRSxpQkFDRXFCLFNBQVMsbUJBQ1RVLEtBQUtGLEdBQ0xHLEtBQUssYUFBY0gsR0FDbkJJLFFBQVFqQyxFQUFFLGlCQUNFcUIsU0FBUyx5QkFDVFUsS0FBSyxLQU9sQyxPQU5BRCxHQUFPSSxHQUFHLFFBQVMsV0FDZmxDLEVBQUVNLE1BQU02QixZQUFZLDRCQUV4QkwsRUFBT00sS0FBSyxRQUFRRixHQUFHLFFBQVMsV0FDNUJULEVBQWFLLEtBRVZBLEdBRVBPLEVBQWMsU0FBVWpCLEdBQ3hCLEdBQUlVLEdBQVNGLEVBQVU1QixFQUFFSSxHQUFHSCxVQUFVcUMsU0FBU1AsS0FBS1EsUUFDcERULEdBQU9ULFNBQVMsdUJBQ2hCUyxFQUFPVSxXQUFXLGNBQ2xCcEIsRUFBZXFCLE9BQU9YLEdBQ3RCWSxXQUFXLFdBQ1BqQixFQUFhSyxJQUNkLE9BRUhhLEVBQWEsV0FDYixHQUFJQyxLQUlKLE9BSEE1QyxHQUFFLGdDQUFnQzJCLEtBQUssV0FDbkNpQixFQUFPQyxLQUFLN0MsRUFBRU0sTUFBTTBCLEtBQUssaUJBRXRCWSxHQUVQRSxFQUFlLFNBQVNDLEdBRXhCLElBQUssR0FEREMsR0FBUyxNQUNKbEMsRUFBSSxFQUFHQSxFQUFJaUMsRUFBV2hDLE9BQVFELElBQ25Da0MsR0FBVUQsRUFBV2pDLEVBR3pCLE9BREFrQyxJQUFVLE1BQ0gsR0FBSUMsUUFBT0QsSUFFbEJFLEVBQWUsU0FBVU4sRUFBUXhCLEdBQ2pDRyxJQUNBdkIsRUFBRTJCLEtBQUtpQixFQUFRLFNBQVVPLEVBQUdDLEdBQ3hCQSxFQUFLcEQsRUFBRXFELEtBQUtELEdBQ1poQyxFQUFlcUIsT0FBT2IsRUFBVXdCLE9BR3BDRSxHQUNBQyxJQUFLLFNBQVVDLEdBQ1gsR0FBSUEsRUFBS3pDLE9BQVMsRUFDZCxLQUFNLElBQUkwQyxPQUFNLG1FQUVwQixPQUFPZCxNQUVYZSxJQUFLLFNBQVVGLEdBQ1gsR0FBSUcsRUFDSixJQUFtQixHQUFmSCxFQUFLekMsT0FDTCxLQUFNLElBQUkwQyxPQUFNLHVFQUVwQixJQUF1QixnQkFBWkQsR0FBSyxHQUVaRyxFQUFNSCxFQUFLLE9BQ1IsQ0FBQSxLQUFJQSxFQUFLLFlBQWNJLFFBSTFCLEtBQU0sSUFBSUgsT0FBTSxtRUFGaEJFLEdBQU1ILEVBQUssR0FBR0ssS0FBSzdELEVBQUVJLEdBQUdILFVBQVVxQyxTQUFTUyxXQUFXLElBTTFELE1BRkExQyxHQUFNeUQsSUFBSUgsR0FDVnRELEVBQU0wRCxRQUFRL0QsRUFBRWdFLE1BQU0sWUFBY0MsUUFBUzFELEtBQ3RDRixHQUVYNkQsSUFBSyxTQUFVVixHQUNYLEdBQW1CLEdBQWZBLEVBQUt6QyxPQUNMLEtBQU0sSUFBSTBDLE9BQU0saUVBRXBCLElBQXVCLGdCQUFaRCxHQUFLLEdBR1osS0FBTSxJQUFJQyxPQUFNLDZEQUVwQixPQUpJekQsR0FBRSxnQ0FBa0N3RCxFQUFLLEdBQUssTUFBTWhDLFNBSWpEbkIsR0FJZixLQUFLOEQsVUFBVXBELFFBQVVmLEVBQUVvRSxjQUFjRCxVQUFVLElBQUssQ0FFcEQsR0FBSUUsR0FBWUYsVUFBVXBELE9BQWNvRCxVQUFVLEtBU2xELE9BUkFuRSxHQUFFc0UsVUFBVXBDLEdBQUcsVUFBVyxTQUFVcUMsSUFDNUJBLEVBQUVOLFNBQVd6RCxHQUFpQitELEVBQUVOLFNBQVd4RCxJQUMzQ2dCLEVBQWF6QixFQUFFLDhCQUl2QnFFLEVBQVdyRSxFQUFFd0UsVUFBV3hFLEVBQUVJLEdBQUdILFVBQVVxQyxTQUFVK0IsR0FFMUNoRSxFQUFNc0IsS0FBSyxXQUNkLEdBQUlSLEdBQVNuQixFQUFFTSxLQUNmbUUsU0FBUUMsSUFBSXZELEVBQ1osSUFBSXdELEdBQVczRSxFQUFFLGVBQ0FxQixTQUFTLHFCQUNUQyxNQUFNSCxFQUFPRyxRQUM5QkgsR0FBT3lELEtBQUtELEVBQ1osSUFBSXZELEdBQWlCRixFQUFrQkMsRUFDdkNBLEdBQU8wRCxTQUFTcEMsT0FBT3JCLEdBQ3ZCRCxFQUFPMkQsSUFBSSxnQkFBaUIsT0FFNUIzRCxFQUFPNEQsTUFBTTdDLEdBQUcsV0FBWSxTQUFVcUMsR0FDbEMsR0FBSUEsRUFBRU4sU0FBVzFELEVBQWdCLENBRTdCLEdBREFnRSxFQUFFUyxpQkFDMEIsSUFBeEJoRixFQUFFcUQsS0FBS2xDLEVBQU8yQyxPQUFjLENBQzVCLEdBQUltQixHQUFNbkMsRUFBYXVCLEVBQVN0QixZQUM1QkgsRUFBU3pCLEVBQU8yQyxNQUFNb0IsTUFBTUQsRUFHNUJaLEdBQVNjLFVBQVksSUFDckJ2QyxFQUFTQSxFQUFPM0IsT0FBTyxFQUFHb0QsRUFBU2MsV0FHdkMsSUFBSXZDLEdBQVNELElBQWE5QixPQUFPK0IsR0FDN0J3QyxHQUFVLENBRWQsSUFBSWYsRUFBUzlCLFFBQVUsRUFBRyxDQUN0QixHQUFJOEMsR0FBTXpDLEVBQU83QixNQUNqQjZCLEdBQVNBLEVBQU8zQixPQUFPLEVBQUdvRCxFQUFTOUIsU0FDL0I4QyxHQUFPekMsRUFBTzdCLFNBQ2RxRSxHQUFVLEdBSWJmLEVBQVNpQixTQUNWMUMsRUFBU2xDLEVBQWFrQyxJQUcxQk0sRUFBYU4sRUFBUXhCLEdBRWpCZ0UsR0FDQS9DLEVBQVlqQixHQUVwQkQsRUFBTzJDLElBQUksU0FNdkIsT0FBT0ssVUFBVSxJQUNiLElBQUssTUFDTCxJQUFLLE1BRUQsTUFBT2IsR0FBWUMsSUFBSVksVUFDM0IsS0FBSyxNQUNMLElBQUssUUFFRCxNQUFPYixHQUFZSSxJQUFJUyxVQUMzQixLQUFLLE1BQ0wsSUFBSyxTQUNMLElBQUssS0FDTCxJQUFLLFNBRUQsTUFBT2IsR0FBWVksSUFBSUMsVUFDM0IsU0FDSSxLQUFNLElBQUlWLE9BQU0sV0FBWVUsVUFBVSxHQUFJLGlCQU0xRG5FLEVBQUVJLEdBQUdILFVBQVVxQyxTQUFXdEMsRUFBRUksR0FBR0YsR0FBR29DLFVBQzlCUyxZQUFhLElBQUssS0FDbEJ1QyxRQUFRLEVBQ1IvQyxRQUFTLEVBQ1Q0QyxVQUFXLEVBQ1hwRCxNQUNJUSxRQUFTLHNCQUlsQmdEIiwiZmlsZSI6ImpxdWVyeS10b2tlbml6ZXItMC4xLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogIGpxdWVyeS10b2tlbml6ZXIgLSB2MC4xXHJcbiAqICBBIGpRdWVyeSB0b29sIHRvIHRva2VuaXplciB2YWx1ZSBvbiBpbnB1dFxyXG4gKiAgaHR0cHM6Ly9naXRodWIuY29tL2xtZnJlc25lZGEvanF1ZXJ5LXRva2VuaXplclxyXG4gKlxyXG4gKiAgTWFkZSBieSBMdWlzIE1pZ3VlbCBGLlxyXG4gKiAgVW5kZXIgTUlUIExpY2Vuc2UgKGh0dHBzOi8vZ2l0aHViLmNvbS9sbWZyZXNuZWRhL2pxdWVyeS10b2tlbml6ZXIvYmxvYi9tYXN0ZXIvTElDRU5TRSlcclxuICovXHJcbjsoZnVuY3Rpb24gKCQpIHsgXHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICAkLnRva2VuaXplciA9ICQudGsgPSB7XHJcbiAgICAgICAgdmVyc2lvbjogXCIwLjFcIlxyXG4gICAgfTtcclxuXHJcbiAgICAkLmZuLnRva2VuaXplciA9ICQuZm4udGsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyICR0aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgS0VZX0NPREVfRU5URVIgPSAxMyxcclxuICAgICAgICAgICAgS0VZX0NPREVfU1VQUiA9IDQ2LFxyXG4gICAgICAgICAgICBLRVlfQ09ERV9ERUwgPSA4O1xyXG4gICAgICAgIC8vUFJJVkFURSBNRVRIT0RTXHJcbiAgICAgICAgdmFyIF91bmlxdWVBcnJheSA9IGZ1bmN0aW9uIChhcnJheSkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IGFycmF5LmNvbmNhdCgpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGEubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSBpICsgMTsgaiA8IGEubGVuZ3RoOyArK2opIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYVtpXSA9PT0gYVtqXSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgYS5zcGxpY2Uoai0tLCAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gYTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIF9nZXRXcmFwcGVyVmFsdWVzID0gZnVuY3Rpb24gKCRpbnB1dCkge1xyXG4gICAgICAgICAgICB2YXIgJHdyYXBwZXJWYWx1ZXMgPSAkKFwiPGRpdj48L2Rpdj5cIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhcInRva2VuaXplci12YWx1ZXNcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC53aWR0aCgkaW5wdXQud2lkdGgoKSAtIDcpO1xyXG4gICAgICAgICAgICByZXR1cm4gJHdyYXBwZXJWYWx1ZXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBfcmVtb3ZlQWxsVG9rZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoXCIudG9rZW5pemVyLXRva2VuXCIpLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgX3JlbW92ZVRva2VuID0gZnVuY3Rpb24oJHRva2Vucykge1xyXG4gICAgICAgICAgICAkdG9rZW5zLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBfZ2V0VG9rZW4gPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyICR0b2tlbiA9ICQoXCI8c3Bhbj48L3NwYW4+XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJ0b2tlbml6ZXItdG9rZW5cIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0KHZhbHVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkYXRhLXZhbHVlXCIsIHZhbHVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnByZXBlbmQoJChcIjxzcGFuPjwvc3Bhbj5cIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhcInRva2VuaXplci10b2tlbi1jbG9zZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHQoXCJ4XCIpKTtcclxuICAgICAgICAgICAgJHRva2VuLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS50b2dnbGVDbGFzcyhcInRva2VuaXplci10b2tlbi1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAkdG9rZW4uZmluZChcInNwYW5cIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfcmVtb3ZlVG9rZW4oJHRva2VuKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiAkdG9rZW47ICBcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIF9zaG93TWF4QWxsID0gZnVuY3Rpb24gKCR3cmFwcGVyVmFsdWVzKSB7XHJcbiAgICAgICAgICAgIHZhciAkdG9rZW4gPSBfZ2V0VG9rZW4oJC5mbi50b2tlbml6ZXIuZGVmYXVsdHMudGV4dC5tYXhfYWxsKTtcclxuICAgICAgICAgICAgJHRva2VuLmFkZENsYXNzKFwidG9rZW5pemVyLXRva2VuLW1heFwiKTtcclxuICAgICAgICAgICAgJHRva2VuLnJlbW92ZUF0dHIoXCJkYXRhLXZhbHVlXCIpO1xyXG4gICAgICAgICAgICAkd3JhcHBlclZhbHVlcy5hcHBlbmQoJHRva2VuKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIF9yZW1vdmVUb2tlbigkdG9rZW4pO1xyXG4gICAgICAgICAgICB9LCAxNTAwKVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgX2dldFZhbHVlcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgdG9rZW5zID0gW107XHJcbiAgICAgICAgICAgICQoXCIudG9rZW5pemVyLXRva2VuW2RhdGEtdmFsdWVdXCIpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdG9rZW5zLnB1c2goJCh0aGlzKS5hdHRyKFwiZGF0YS12YWx1ZVwiKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gdG9rZW5zO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgX2J1aWxkUmVnRXhwID0gZnVuY3Rpb24oc2VwYXJhdG9ycykge1xyXG4gICAgICAgICAgICB2YXIgc3RyUmVnID0gXCJcXHMqW1wiO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlcGFyYXRvcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHN0clJlZyArPSBzZXBhcmF0b3JzW2ldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHN0clJlZyArPSBcIl1cXHMqXCI7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVnRXhwKHN0clJlZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBfcHJpbnRUb2tlbnMgPSBmdW5jdGlvbiAodG9rZW5zLCAkd3JhcHBlclZhbHVlcykge1xyXG4gICAgICAgICAgICBfcmVtb3ZlQWxsVG9rZW4oKTtcclxuICAgICAgICAgICAgJC5lYWNoKHRva2VucywgZnVuY3Rpb24gKGssIGVsKSB7XHJcbiAgICAgICAgICAgICAgICBlbCA9ICQudHJpbShlbCk7XHJcbiAgICAgICAgICAgICAgICAkd3JhcHBlclZhbHVlcy5hcHBlbmQoX2dldFRva2VuKGVsKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgX29wZXJhdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKGFyZ3MpIHtcclxuICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOw7ptZXJvIGRlIGFyZ3VtZW50b3MgaW52w6FsaWRvcywgc2UgcmVxdWllcmUgKCdvcHRpb24nKSBzb2xhbWVudGVcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX2dldFZhbHVlcygpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3RyO1xyXG4gICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoICE9IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOw7ptZXJvIGRlIGFyZ3VtZW50b3MgaW52w6FsaWRvcywgc2UgcmVxdWllcmUgKCdvcHRpb24nLCBTdHJpbmd8QXJyYXkpXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmdzWzFdID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9vbmx5IGlucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyID0gYXJnc1sxXTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYXJnc1sxXSBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9hcnJheSBpbnB1dFxyXG4gICAgICAgICAgICAgICAgICAgIHN0ciA9IGFyZ3NbMV0uam9pbigkLmZuLnRva2VuaXplci5kZWZhdWx0cy5zZXBhcmF0b3JzWzBdKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2VndW5kbyBwYXLDoW1ldHJvIGludsOhbGlkbywgc2UgcmVxdWllcmUgKCdvcHRpb24nLCBTdHJpbmd8QXJyYXkpXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHRoaXMudmFsKHN0cik7XHJcbiAgICAgICAgICAgICAgICAkdGhpcy50cmlnZ2VyKCQuRXZlbnQoXCJrZXlwcmVzc1wiLCB7IGtleUNvZGU6IEtFWV9DT0RFX0VOVEVSIH0pKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZGVsOiBmdW5jdGlvbiAoYXJncykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoICE9IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOw7ptZXJvIGRlIGFyZ3VtZW50b3MgaW52w6FsaWRvcywgc2UgcmVxdWllcmUgKCdvcHRpb24nLCBTdHJpbmcpXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmdzWzFdID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIi50b2tlbml6ZXItdG9rZW5bZGF0YS12YWx1ZT0nXCIgKyBhcmdzWzFdICsgXCInXVwiKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2VndW5kbyBwYXLDoW1ldHJvIGludsOhbGlkbywgc2UgcmVxdWllcmUgKCdvcHRpb24nLCBTdHJpbmcpXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGggfHwgJC5pc1BsYWluT2JqZWN0KGFyZ3VtZW50c1swXSkpIHtcclxuICAgICAgICAgICAgLy9JTklUIEJJTkRJTkdcclxuICAgICAgICAgICAgdmFyIHNldHRpbmdzID0gIWFyZ3VtZW50cy5sZW5ndGggPyB7fSA6IGFyZ3VtZW50c1swXTtcclxuICAgICAgICAgICAgJChkb2N1bWVudCkub24oXCJrZXlkb3duXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IEtFWV9DT0RFX1NVUFIgfHwgZS5rZXlDb2RlID09IEtFWV9DT0RFX0RFTCkge1xyXG4gICAgICAgICAgICAgICAgICAgIF9yZW1vdmVUb2tlbigkKFwiLnRva2VuaXplci10b2tlbi1hY3RpdmVcIikpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHNldHRpbmdzID0gJC5leHRlbmQoe30sICQuZm4udG9rZW5pemVyLmRlZmF1bHRzLCBzZXR0aW5ncyk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gJHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgJGlucHV0ID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCRpbnB1dCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgJHdyYXBwZXIgPSAkKFwiPGRpdj48L2Rpdj5cIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJ0b2tlbml6ZXItd3JhcHBlclwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC53aWR0aCgkaW5wdXQud2lkdGgoKSk7XHJcbiAgICAgICAgICAgICAgICAkaW5wdXQud3JhcCgkd3JhcHBlcik7XHJcbiAgICAgICAgICAgICAgICB2YXIgJHdyYXBwZXJWYWx1ZXMgPSBfZ2V0V3JhcHBlclZhbHVlcygkaW5wdXQpO1xyXG4gICAgICAgICAgICAgICAgJGlucHV0LnBhcmVudCgpLmFwcGVuZCgkd3JhcHBlclZhbHVlcyk7XHJcbiAgICAgICAgICAgICAgICAkaW5wdXQuY3NzKFwibWFyZ2luLWJvdHRvbVwiLCBcIjBweFwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAkaW5wdXQub2ZmKCkub24oXCJrZXlwcmVzc1wiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT0gS0VZX0NPREVfRU5URVIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJC50cmltKCRpbnB1dC52YWwoKSkgIT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlZyA9IF9idWlsZFJlZ0V4cChzZXR0aW5ncy5zZXBhcmF0b3JzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b2tlbnMgPSAkaW5wdXQudmFsKCkuc3BsaXQocmVnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnRyb2xhbW9zIG1heF9pbnB1dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLm1heF9pbnB1dCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbnMgPSB0b2tlbnMuc3BsaWNlKDAsIHNldHRpbmdzLm1heF9pbnB1dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRva2VucyA9IF9nZXRWYWx1ZXMoKS5jb25jYXQodG9rZW5zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaG93TWF4ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnRyb2xhbW9zIG1heF9hbGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5tYXhfYWxsID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsZW4gPSB0b2tlbnMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VucyA9IHRva2Vucy5zcGxpY2UoMCwgc2V0dGluZ3MubWF4X2FsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxlbiAhPSB0b2tlbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dNYXggPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNldHRpbmdzLnJlcGVhdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VucyA9IF91bmlxdWVBcnJheSh0b2tlbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wcmludFRva2Vucyh0b2tlbnMsICR3cmFwcGVyVmFsdWVzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hvd01heClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc2hvd01heEFsbCgkd3JhcHBlclZhbHVlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgJGlucHV0LnZhbChcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy9BTk9USEVSIFJFUVVFU1RcclxuICAgICAgICAgICAgc3dpdGNoKGFyZ3VtZW50c1swXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcImdldFwiOlxyXG4gICAgICAgICAgICAgICAgY2FzZSBcInZhbFwiOlxyXG4gICAgICAgICAgICAgICAgICAgIC8vZ2V0IHZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9vcGVyYXRpb25zLmdldChhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcInNldFwiOlxyXG4gICAgICAgICAgICAgICAgY2FzZSBcImlucHV0XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgLy9zZXQgdmFsdWVcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX29wZXJhdGlvbnMuc2V0KGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiZGVsXCI6XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiZGVsZXRlXCI6XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwicm1cIjpcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJyZW1vdmVcIjpcclxuICAgICAgICAgICAgICAgICAgICAvL3JlbW92ZSB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfb3BlcmF0aW9ucy5kZWwoYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT3BjacOzbiAnXCIrIGFyZ3VtZW50c1swXSArXCInIG5vIHbDoWxpZGFcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vU0VUVElOR1NcclxuICAgICQuZm4udG9rZW5pemVyLmRlZmF1bHRzID0gJC5mbi50ay5kZWZhdWx0cyA9IHtcclxuICAgICAgICBzZXBhcmF0b3JzOiBbXCIsXCIsIFwiO1wiXSxcclxuICAgICAgICByZXBlYXQ6IGZhbHNlLFxyXG4gICAgICAgIG1heF9hbGw6IDAsXHJcbiAgICAgICAgbWF4X2lucHV0OiAwLFxyXG4gICAgICAgIHRleHQ6IHtcclxuICAgICAgICAgICAgbWF4X2FsbDogXCJNw6F4aW1vIGFsY2FuemFkb1wiXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbn0pKGpRdWVyeSk7XHJcblxyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=