!function(e){"use strict";e.tokenizer={version:"0.1",KEY_CODE:{ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_TOP:38,BACKSPACE:32,COMMA:188,CTRL:17,DEL:8,DOT:190,ENTER:13,ESC:27,SHIFT:16,SUPR:46,TAB:9}},e.fn.tokenizer=function(){var n=this,t=function(e){for(var n=e.concat(),t=0;t<n.length;++t)for(var r=t+1;r<n.length;++r)n[t]===n[r]&&n.splice(r--,1);return n},r=function(n){var t=e("<div></div>").addClass("tokenizer-values").width(n.width()-7);return t},o=function(){e(".tokenizer-token",n.parent()).remove()},a=function(n){n.each(function(){e(this).remove()})},i=function(n,t){var r=e("<span></span>").addClass("tokenizer-token").text(n).attr("data-value",n).prepend(e("<span></span>").addClass("tokenizer-token-close").text("x"));return r.on("click",t.onClickToken),r.find("span").on("click",function(){a(r)}),r},s=function(n,t){var r=i(e.fn.tokenizer.defaults.text.max_all,t);r.addClass("tokenizer-token-max"),r.removeAttr("data-value"),n.append(r),setTimeout(function(){a(r)},1500)},u=function(){var t=[];return e(".tokenizer-token[data-value]",n.parent()).each(function(){t.push(e(this).attr("data-value"))}),t},l=function(e){for(var n="[",t=0;t<e.length;t++)n+=e[t];return n+="]",new RegExp(n)},c=function(n,t,r){o(),e.each(n,function(n,o){if(o=e.trim(o),""!=o){var a=i(o,r);t.append(a)}})},d={get:function(e){if(e.length>1)throw new Error("Número de argumentos inválidos, se requiere ('option') solamente");return u()},set:function(t){var r;if(2!=t.length)throw new Error("Número de argumentos inválidos, se requiere ('option', String|Array)");if("string"==typeof t[1])r=t[1];else{if(!(t[1]instanceof Array))throw new Error("Segundo parámetro inválido, se requiere ('option', String|Array)");r=t[1].join(e.fn.tokenizer.defaults.separators[0])}return n.val(r),n.trigger(e.Event("keydown",{keyCode:e.tokenizer.KEY_CODE.ENTER})),n},del:function(t){if(2!=t.length)throw new Error("Número de argumentos inválidos, se requiere ('option', String)");if("string"!=typeof t[1])throw new Error("Segundo parámetro inválido, se requiere ('option', String)");return a(e(".tokenizer-token[data-value='"+t[1]+"']")),n}};if(!arguments.length||e.isPlainObject(arguments[0])){var f=arguments.length?arguments[0]:{};return e(document).on("keydown",function(n){n.keyCode==e.tokenizer.KEY_CODE.SUPR&&(a(e(".tokenizer-token-active")),f.onDeleteToken())}),f=e.extend({},e.fn.tokenizer.defaults,f),n.each(function(){var n=e(this);console.log(n);var o=e("<div></div>").addClass("tokenizer-wrapper").width(n.width());n.wrap(o);var a=r(n);n.parent().append(a),n.css("margin-bottom","0px"),n.off().on("keydown",function(r){if(r.keyCode==f.keyCodeCreate){if(r.preventDefault(),""!=e.trim(n.val())){var o=l(f.separators),i=n.val().split(o);f.max_input>0&&(i=i.splice(0,f.max_input));var i=u().concat(i),d=!1;if(f.max_all>0){var v=i.length;i=i.splice(0,f.max_all),v!=i.length&&(d=!0)}f.repeat||(i=t(i)),c(i,a,f),d&&s(a,f)}n.val("")}})})}switch(arguments[0]){case"get":case"val":return d.get(arguments);case"set":case"input":return d.set(arguments);case"del":case"delete":case"rm":case"remove":return d.del(arguments);default:throw new Error("Opción '"+arguments[0]+"' no válida")}},e.fn.tokenizer.defaults={separators:[",",";"],keyCodeCreate:e.tokenizer.KEY_CODE.ENTER,repeat:!1,max_all:0,max_input:0,text:{max_all:"Máximo alcanzado"},onClickToken:function(){e(this).toggleClass("tokenizer-token-active")},onDeleteToken:function(){}}}(jQuery);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS10b2tlbml6ZXItMC4xLmpzIl0sIm5hbWVzIjpbIiQiLCJ0b2tlbml6ZXIiLCJ2ZXJzaW9uIiwiS0VZX0NPREUiLCJBUlJPV19ET1dOIiwiQVJST1dfTEVGVCIsIkFSUk9XX1JJR0hUIiwiQVJST1dfVE9QIiwiQkFDS1NQQUNFIiwiQ09NTUEiLCJDVFJMIiwiREVMIiwiRE9UIiwiRU5URVIiLCJFU0MiLCJTSElGVCIsIlNVUFIiLCJUQUIiLCJmbiIsIiR0aGlzIiwidGhpcyIsIl91bmlxdWVBcnJheSIsImFycmF5IiwiYSIsImNvbmNhdCIsImkiLCJsZW5ndGgiLCJqIiwic3BsaWNlIiwiX2dldFdyYXBwZXJWYWx1ZXMiLCIkaW5wdXQiLCIkd3JhcHBlclZhbHVlcyIsImFkZENsYXNzIiwid2lkdGgiLCJfcmVtb3ZlQWxsVG9rZW4iLCJwYXJlbnQiLCJyZW1vdmUiLCJfcmVtb3ZlVG9rZW4iLCIkdG9rZW5zIiwiZWFjaCIsIl9nZXRUb2tlbiIsInZhbHVlIiwic2V0dGluZ3MiLCIkdG9rZW4iLCJ0ZXh0IiwiYXR0ciIsInByZXBlbmQiLCJvbiIsIm9uQ2xpY2tUb2tlbiIsImZpbmQiLCJfc2hvd01heEFsbCIsImRlZmF1bHRzIiwibWF4X2FsbCIsInJlbW92ZUF0dHIiLCJhcHBlbmQiLCJzZXRUaW1lb3V0IiwiX2dldFZhbHVlcyIsInRva2VucyIsInB1c2giLCJfYnVpbGRSZWdFeHAiLCJzZXBhcmF0b3JzIiwic3RyUmVnIiwiUmVnRXhwIiwiX3ByaW50VG9rZW5zIiwiayIsImVsIiwidHJpbSIsIiR0ayIsIl9vcGVyYXRpb25zIiwiZ2V0IiwiYXJncyIsIkVycm9yIiwic2V0Iiwic3RyIiwiQXJyYXkiLCJqb2luIiwidmFsIiwidHJpZ2dlciIsIkV2ZW50Iiwia2V5Q29kZSIsImRlbCIsImFyZ3VtZW50cyIsImlzUGxhaW5PYmplY3QiLCJkb2N1bWVudCIsImUiLCJvbkRlbGV0ZVRva2VuIiwiZXh0ZW5kIiwiY29uc29sZSIsImxvZyIsIiR3cmFwcGVyIiwid3JhcCIsImNzcyIsIm9mZiIsImtleUNvZGVDcmVhdGUiLCJwcmV2ZW50RGVmYXVsdCIsInJlZyIsInNwbGl0IiwibWF4X2lucHV0Iiwic2hvd01heCIsImxlbiIsInJlcGVhdCIsInRvZ2dsZUNsYXNzIiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQ0FRQyxTQUFXQSxHQUNSLFlBRUFBLEdBQUVDLFdBQ0VDLFFBQVMsTUFDVEMsVUFDSUMsV0FBWSxHQUNaQyxXQUFZLEdBQ1pDLFlBQWEsR0FDYkMsVUFBVyxHQUNYQyxVQUFXLEdBQ1hDLE1BQU8sSUFDUEMsS0FBTSxHQUNOQyxJQUFLLEVBQ0xDLElBQUssSUFDTEMsTUFBTyxHQUNQQyxJQUFLLEdBQ0xDLE1BQU8sR0FDUEMsS0FBTSxHQUNOQyxJQUFLLElBSWJqQixFQUFFa0IsR0FBR2pCLFVBQVksV0FDYixHQUFJa0IsR0FBUUMsS0FHUkMsRUFBZSxTQUFVQyxHQUV6QixJQUFLLEdBRERDLEdBQUlELEVBQU1FLFNBQ0xDLEVBQUksRUFBR0EsRUFBSUYsRUFBRUcsU0FBVUQsRUFDNUIsSUFBSyxHQUFJRSxHQUFJRixFQUFJLEVBQUdFLEVBQUlKLEVBQUVHLFNBQVVDLEVBQzVCSixFQUFFRSxLQUFPRixFQUFFSSxJQUNYSixFQUFFSyxPQUFPRCxJQUFLLEVBRzFCLE9BQU9KLElBRVBNLEVBQW9CLFNBQVVDLEdBQzlCLEdBQUlDLEdBQWlCL0IsRUFBRSxlQUNOZ0MsU0FBUyxvQkFDVEMsTUFBTUgsRUFBT0csUUFBVSxFQUN4QyxPQUFPRixJQUVQRyxFQUFrQixXQUNsQmxDLEVBQUUsbUJBQW9CbUIsRUFBTWdCLFVBQVVDLFVBRXRDQyxFQUFlLFNBQVNDLEdBQ3hCQSxFQUFRQyxLQUFLLFdBQ1R2QyxFQUFFb0IsTUFBTWdCLFlBR1pJLEVBQVksU0FBVUMsRUFBT0MsR0FDN0IsR0FBSUMsR0FBUzNDLEVBQUUsaUJBQ0VnQyxTQUFTLG1CQUNUWSxLQUFLSCxHQUNMSSxLQUFLLGFBQWNKLEdBQ25CSyxRQUFROUMsRUFBRSxpQkFDRWdDLFNBQVMseUJBQ1RZLEtBQUssS0FLbEMsT0FKQUQsR0FBT0ksR0FBRyxRQUFTTCxFQUFTTSxjQUM1QkwsRUFBT00sS0FBSyxRQUFRRixHQUFHLFFBQVMsV0FDNUJWLEVBQWFNLEtBRVZBLEdBRVBPLEVBQWMsU0FBVW5CLEVBQWdCVyxHQUN4QyxHQUFJQyxHQUFTSCxFQUFVeEMsRUFBRWtCLEdBQUdqQixVQUFVa0QsU0FBU1AsS0FBS1EsUUFBU1YsRUFDN0RDLEdBQU9YLFNBQVMsdUJBQ2hCVyxFQUFPVSxXQUFXLGNBQ2xCdEIsRUFBZXVCLE9BQU9YLEdBQ3RCWSxXQUFXLFdBQ1BsQixFQUFhTSxJQUNkLE9BRUhhLEVBQWEsV0FDYixHQUFJQyxLQUlKLE9BSEF6RCxHQUFFLCtCQUFnQ21CLEVBQU1nQixVQUFVSSxLQUFLLFdBQ25Ea0IsRUFBT0MsS0FBSzFELEVBQUVvQixNQUFNeUIsS0FBSyxpQkFFdEJZLEdBRVBFLEVBQWUsU0FBU0MsR0FFeEIsSUFBSyxHQUREQyxHQUFTLElBQ0pwQyxFQUFJLEVBQUdBLEVBQUltQyxFQUFXbEMsT0FBUUQsSUFDbkNvQyxHQUFVRCxFQUFXbkMsRUFHekIsT0FEQW9DLElBQVUsSUFDSCxHQUFJQyxRQUFPRCxJQUVsQkUsRUFBZSxTQUFVTixFQUFRMUIsRUFBZ0JXLEdBQ2pEUixJQUNBbEMsRUFBRXVDLEtBQUtrQixFQUFRLFNBQVVPLEVBQUdDLEdBRXhCLEdBREFBLEVBQUtqRSxFQUFFa0UsS0FBS0QsR0FDRixJQUFOQSxFQUFVLENBQ1YsR0FBSUUsR0FBTTNCLEVBQVV5QixFQUFJdkIsRUFDeEJYLEdBQWV1QixPQUFPYSxPQUk5QkMsR0FDQUMsSUFBSyxTQUFVQyxHQUNYLEdBQUlBLEVBQUs1QyxPQUFTLEVBQ2QsS0FBTSxJQUFJNkMsT0FBTSxtRUFFcEIsT0FBT2YsTUFFWGdCLElBQUssU0FBVUYsR0FDWCxHQUFJRyxFQUNKLElBQW1CLEdBQWZILEVBQUs1QyxPQUNMLEtBQU0sSUFBSTZDLE9BQU0sdUVBRXBCLElBQXVCLGdCQUFaRCxHQUFLLEdBRVpHLEVBQU1ILEVBQUssT0FDUixDQUFBLEtBQUlBLEVBQUssWUFBY0ksUUFJMUIsS0FBTSxJQUFJSCxPQUFNLG1FQUZoQkUsR0FBTUgsRUFBSyxHQUFHSyxLQUFLM0UsRUFBRWtCLEdBQUdqQixVQUFVa0QsU0FBU1MsV0FBVyxJQU0xRCxNQUZBekMsR0FBTXlELElBQUlILEdBQ1Z0RCxFQUFNMEQsUUFBUTdFLEVBQUU4RSxNQUFNLFdBQWFDLFFBQVMvRSxFQUFFQyxVQUFVRSxTQUFTVSxTQUMxRE0sR0FFWDZELElBQUssU0FBVVYsR0FDWCxHQUFtQixHQUFmQSxFQUFLNUMsT0FDTCxLQUFNLElBQUk2QyxPQUFNLGlFQUVwQixJQUF1QixnQkFBWkQsR0FBSyxHQUdaLEtBQU0sSUFBSUMsT0FBTSw2REFFcEIsT0FKSWxDLEdBQWFyQyxFQUFFLGdDQUFrQ3NFLEVBQUssR0FBSyxPQUl4RG5ELEdBSWYsS0FBSzhELFVBQVV2RCxRQUFVMUIsRUFBRWtGLGNBQWNELFVBQVUsSUFBSyxDQUVwRCxHQUFJdkMsR0FBWXVDLFVBQVV2RCxPQUFjdUQsVUFBVSxLQVVsRCxPQVRBakYsR0FBRW1GLFVBQVVwQyxHQUFHLFVBQVcsU0FBVXFDLEdBQzVCQSxFQUFFTCxTQUFXL0UsRUFBRUMsVUFBVUUsU0FBU2EsT0FDbENxQixFQUFhckMsRUFBRSw0QkFDZjBDLEVBQVMyQyxtQkFJakIzQyxFQUFXMUMsRUFBRXNGLFVBQVd0RixFQUFFa0IsR0FBR2pCLFVBQVVrRCxTQUFVVCxHQUUxQ3ZCLEVBQU1vQixLQUFLLFdBQ2QsR0FBSVQsR0FBUzlCLEVBQUVvQixLQUNmbUUsU0FBUUMsSUFBSTFELEVBQ1osSUFBSTJELEdBQVd6RixFQUFFLGVBQ0FnQyxTQUFTLHFCQUNUQyxNQUFNSCxFQUFPRyxRQUM5QkgsR0FBTzRELEtBQUtELEVBQ1osSUFBSTFELEdBQWlCRixFQUFrQkMsRUFDdkNBLEdBQU9LLFNBQVNtQixPQUFPdkIsR0FDdkJELEVBQU82RCxJQUFJLGdCQUFpQixPQUU1QjdELEVBQU84RCxNQUFNN0MsR0FBRyxVQUFXLFNBQVVxQyxHQUNqQyxHQUFJQSxFQUFFTCxTQUFXckMsRUFBU21ELGNBQWUsQ0FFckMsR0FEQVQsRUFBRVUsaUJBQzBCLElBQXhCOUYsRUFBRWtFLEtBQUtwQyxFQUFPOEMsT0FBYyxDQUM1QixHQUFJbUIsR0FBTXBDLEVBQWFqQixFQUFTa0IsWUFDNUJILEVBQVMzQixFQUFPOEMsTUFBTW9CLE1BQU1ELEVBRzVCckQsR0FBU3VELFVBQVksSUFDckJ4QyxFQUFTQSxFQUFPN0IsT0FBTyxFQUFHYyxFQUFTdUQsV0FHdkMsSUFBSXhDLEdBQVNELElBQWFoQyxPQUFPaUMsR0FDN0J5QyxHQUFVLENBRWQsSUFBSXhELEVBQVNVLFFBQVUsRUFBRyxDQUN0QixHQUFJK0MsR0FBTTFDLEVBQU8vQixNQUNqQitCLEdBQVNBLEVBQU83QixPQUFPLEVBQUdjLEVBQVNVLFNBQy9CK0MsR0FBTzFDLEVBQU8vQixTQUNkd0UsR0FBVSxHQUlieEQsRUFBUzBELFNBQ1YzQyxFQUFTcEMsRUFBYW9DLElBRzFCTSxFQUFhTixFQUFRMUIsRUFBZ0JXLEdBRWpDd0QsR0FDQWhELEVBQVluQixFQUFnQlcsR0FFcENaLEVBQU84QyxJQUFJLFNBTXZCLE9BQU9LLFVBQVUsSUFDYixJQUFLLE1BQ0wsSUFBSyxNQUVELE1BQU9iLEdBQVlDLElBQUlZLFVBQzNCLEtBQUssTUFDTCxJQUFLLFFBRUQsTUFBT2IsR0FBWUksSUFBSVMsVUFDM0IsS0FBSyxNQUNMLElBQUssU0FDTCxJQUFLLEtBQ0wsSUFBSyxTQUVELE1BQU9iLEdBQVlZLElBQUlDLFVBQzNCLFNBQ0ksS0FBTSxJQUFJVixPQUFNLFdBQVlVLFVBQVUsR0FBSSxpQkFNMURqRixFQUFFa0IsR0FBR2pCLFVBQVVrRCxVQUNYUyxZQUFhLElBQUssS0FDbEJpQyxjQUFlN0YsRUFBRUMsVUFBVUUsU0FBU1UsTUFDcEN1RixRQUFRLEVBQ1JoRCxRQUFTLEVBQ1Q2QyxVQUFXLEVBQ1hyRCxNQUNJUSxRQUFTLG9CQUViSixhQUFjLFdBQ1ZoRCxFQUFFb0IsTUFBTWlGLFlBQVksMkJBRXhCaEIsY0FBZSxlQUdwQmlCIiwiZmlsZSI6ImpxdWVyeS10b2tlbml6ZXItMC4xLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogIGpxdWVyeS10b2tlbml6ZXIgLSB2MC4xXHJcbiAqICBBIGpRdWVyeSB0b29sIHRvIHRva2VuaXplciB2YWx1ZSBvbiBpbnB1dFxyXG4gKiAgaHR0cHM6Ly9naXRodWIuY29tL2xtZnJlc25lZGEvanF1ZXJ5LXRva2VuaXplclxyXG4gKlxyXG4gKiAgTWFkZSBieSBMdWlzIE1pZ3VlbCBGLlxyXG4gKiAgVW5kZXIgTUlUIExpY2Vuc2UgKGh0dHBzOi8vZ2l0aHViLmNvbS9sbWZyZXNuZWRhL2pxdWVyeS10b2tlbml6ZXIvYmxvYi9tYXN0ZXIvTElDRU5TRSlcclxuICovXHJcbjsoZnVuY3Rpb24gKCQpIHsgXHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICAkLnRva2VuaXplciA9IHtcclxuICAgICAgICB2ZXJzaW9uOiBcIjAuMVwiLFxyXG4gICAgICAgIEtFWV9DT0RFOiB7XHJcbiAgICAgICAgICAgIEFSUk9XX0RPV046IDQwLFxyXG4gICAgICAgICAgICBBUlJPV19MRUZUOiAzNyxcclxuICAgICAgICAgICAgQVJST1dfUklHSFQ6IDM5LFxyXG4gICAgICAgICAgICBBUlJPV19UT1A6IDM4LFxyXG4gICAgICAgICAgICBCQUNLU1BBQ0U6IDMyLFxyXG4gICAgICAgICAgICBDT01NQTogMTg4LFxyXG4gICAgICAgICAgICBDVFJMOiAxNyxcclxuICAgICAgICAgICAgREVMOiA4LFxyXG4gICAgICAgICAgICBET1Q6IDE5MCxcclxuICAgICAgICAgICAgRU5URVI6IDEzLFxyXG4gICAgICAgICAgICBFU0M6IDI3LFxyXG4gICAgICAgICAgICBTSElGVDogMTYsXHJcbiAgICAgICAgICAgIFNVUFI6IDQ2LFxyXG4gICAgICAgICAgICBUQUI6IDlcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgICQuZm4udG9rZW5pemVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciAkdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgICAgIC8vUFJJVkFURSBNRVRIT0RTXHJcbiAgICAgICAgdmFyIF91bmlxdWVBcnJheSA9IGZ1bmN0aW9uIChhcnJheSkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IGFycmF5LmNvbmNhdCgpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGEubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSBpICsgMTsgaiA8IGEubGVuZ3RoOyArK2opIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYVtpXSA9PT0gYVtqXSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgYS5zcGxpY2Uoai0tLCAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gYTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIF9nZXRXcmFwcGVyVmFsdWVzID0gZnVuY3Rpb24gKCRpbnB1dCkge1xyXG4gICAgICAgICAgICB2YXIgJHdyYXBwZXJWYWx1ZXMgPSAkKFwiPGRpdj48L2Rpdj5cIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhcInRva2VuaXplci12YWx1ZXNcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC53aWR0aCgkaW5wdXQud2lkdGgoKSAtIDcpO1xyXG4gICAgICAgICAgICByZXR1cm4gJHdyYXBwZXJWYWx1ZXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBfcmVtb3ZlQWxsVG9rZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoXCIudG9rZW5pemVyLXRva2VuXCIsICR0aGlzLnBhcmVudCgpKS5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIF9yZW1vdmVUb2tlbiA9IGZ1bmN0aW9uKCR0b2tlbnMpIHtcclxuICAgICAgICAgICAgJHRva2Vucy5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgX2dldFRva2VuID0gZnVuY3Rpb24gKHZhbHVlLCBzZXR0aW5ncykge1xyXG4gICAgICAgICAgICB2YXIgJHRva2VuID0gJChcIjxzcGFuPjwvc3Bhbj5cIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhcInRva2VuaXplci10b2tlblwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHQodmFsdWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcImRhdGEtdmFsdWVcIiwgdmFsdWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucHJlcGVuZCgkKFwiPHNwYW4+PC9zcGFuPlwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKFwidG9rZW5pemVyLXRva2VuLWNsb3NlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGV4dChcInhcIikpO1xyXG4gICAgICAgICAgICAkdG9rZW4ub24oXCJjbGlja1wiLCBzZXR0aW5ncy5vbkNsaWNrVG9rZW4pO1xyXG4gICAgICAgICAgICAkdG9rZW4uZmluZChcInNwYW5cIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfcmVtb3ZlVG9rZW4oJHRva2VuKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiAkdG9rZW47ICBcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIF9zaG93TWF4QWxsID0gZnVuY3Rpb24gKCR3cmFwcGVyVmFsdWVzLCBzZXR0aW5ncykge1xyXG4gICAgICAgICAgICB2YXIgJHRva2VuID0gX2dldFRva2VuKCQuZm4udG9rZW5pemVyLmRlZmF1bHRzLnRleHQubWF4X2FsbCwgc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAkdG9rZW4uYWRkQ2xhc3MoXCJ0b2tlbml6ZXItdG9rZW4tbWF4XCIpO1xyXG4gICAgICAgICAgICAkdG9rZW4ucmVtb3ZlQXR0cihcImRhdGEtdmFsdWVcIik7XHJcbiAgICAgICAgICAgICR3cmFwcGVyVmFsdWVzLmFwcGVuZCgkdG9rZW4pO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgX3JlbW92ZVRva2VuKCR0b2tlbik7XHJcbiAgICAgICAgICAgIH0sIDE1MDApXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBfZ2V0VmFsdWVzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciB0b2tlbnMgPSBbXTtcclxuICAgICAgICAgICAgJChcIi50b2tlbml6ZXItdG9rZW5bZGF0YS12YWx1ZV1cIiwgJHRoaXMucGFyZW50KCkpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdG9rZW5zLnB1c2goJCh0aGlzKS5hdHRyKFwiZGF0YS12YWx1ZVwiKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gdG9rZW5zO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgX2J1aWxkUmVnRXhwID0gZnVuY3Rpb24oc2VwYXJhdG9ycykge1xyXG4gICAgICAgICAgICB2YXIgc3RyUmVnID0gXCJcXFtcIjtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZXBhcmF0b3JzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBzdHJSZWcgKz0gc2VwYXJhdG9yc1tpXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzdHJSZWcgKz0gXCJdXCI7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVnRXhwKHN0clJlZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBfcHJpbnRUb2tlbnMgPSBmdW5jdGlvbiAodG9rZW5zLCAkd3JhcHBlclZhbHVlcywgc2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgX3JlbW92ZUFsbFRva2VuKCk7XHJcbiAgICAgICAgICAgICQuZWFjaCh0b2tlbnMsIGZ1bmN0aW9uIChrLCBlbCkge1xyXG4gICAgICAgICAgICAgICAgZWwgPSAkLnRyaW0oZWwpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGVsICE9IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgJHRrID0gX2dldFRva2VuKGVsLCBzZXR0aW5ncylcclxuICAgICAgICAgICAgICAgICAgICAkd3JhcHBlclZhbHVlcy5hcHBlbmQoJHRrKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBfb3BlcmF0aW9ucyA9IHtcclxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoYXJncykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk7Dum1lcm8gZGUgYXJndW1lbnRvcyBpbnbDoWxpZG9zLCBzZSByZXF1aWVyZSAoJ29wdGlvbicpIHNvbGFtZW50ZVwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0VmFsdWVzKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGFyZ3MpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzdHI7XHJcbiAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggIT0gMikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk7Dum1lcm8gZGUgYXJndW1lbnRvcyBpbnbDoWxpZG9zLCBzZSByZXF1aWVyZSAoJ29wdGlvbicsIFN0cmluZ3xBcnJheSlcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGFyZ3NbMV0gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL29ubHkgaW5wdXRcclxuICAgICAgICAgICAgICAgICAgICBzdHIgPSBhcmdzWzFdO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhcmdzWzFdIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL2FycmF5IGlucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyID0gYXJnc1sxXS5qb2luKCQuZm4udG9rZW5pemVyLmRlZmF1bHRzLnNlcGFyYXRvcnNbMF0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTZWd1bmRvIHBhcsOhbWV0cm8gaW52w6FsaWRvLCBzZSByZXF1aWVyZSAoJ29wdGlvbicsIFN0cmluZ3xBcnJheSlcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkdGhpcy52YWwoc3RyKTtcclxuICAgICAgICAgICAgICAgICR0aGlzLnRyaWdnZXIoJC5FdmVudChcImtleWRvd25cIiwgeyBrZXlDb2RlOiAkLnRva2VuaXplci5LRVlfQ09ERS5FTlRFUiB9KSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXM7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRlbDogZnVuY3Rpb24gKGFyZ3MpIHtcclxuICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCAhPSAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTsO6bWVybyBkZSBhcmd1bWVudG9zIGludsOhbGlkb3MsIHNlIHJlcXVpZXJlICgnb3B0aW9uJywgU3RyaW5nKVwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYXJnc1sxXSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9yZW1vdmVUb2tlbigkKFwiLnRva2VuaXplci10b2tlbltkYXRhLXZhbHVlPSdcIiArIGFyZ3NbMV0gKyBcIiddXCIpKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2VndW5kbyBwYXLDoW1ldHJvIGludsOhbGlkbywgc2UgcmVxdWllcmUgKCdvcHRpb24nLCBTdHJpbmcpXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGggfHwgJC5pc1BsYWluT2JqZWN0KGFyZ3VtZW50c1swXSkpIHtcclxuICAgICAgICAgICAgLy9JTklUIEJJTkRJTkdcclxuICAgICAgICAgICAgdmFyIHNldHRpbmdzID0gIWFyZ3VtZW50cy5sZW5ndGggPyB7fSA6IGFyZ3VtZW50c1swXTtcclxuICAgICAgICAgICAgJChkb2N1bWVudCkub24oXCJrZXlkb3duXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09ICQudG9rZW5pemVyLktFWV9DT0RFLlNVUFIpIHtcclxuICAgICAgICAgICAgICAgICAgICBfcmVtb3ZlVG9rZW4oJChcIi50b2tlbml6ZXItdG9rZW4tYWN0aXZlXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncy5vbkRlbGV0ZVRva2VuKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgc2V0dGluZ3MgPSAkLmV4dGVuZCh7fSwgJC5mbi50b2tlbml6ZXIuZGVmYXVsdHMsIHNldHRpbmdzKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiAkdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciAkaW5wdXQgPSAkKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJGlucHV0KTtcclxuICAgICAgICAgICAgICAgIHZhciAkd3JhcHBlciA9ICQoXCI8ZGl2PjwvZGl2PlwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhcInRva2VuaXplci13cmFwcGVyXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLndpZHRoKCRpbnB1dC53aWR0aCgpKTtcclxuICAgICAgICAgICAgICAgICRpbnB1dC53cmFwKCR3cmFwcGVyKTtcclxuICAgICAgICAgICAgICAgIHZhciAkd3JhcHBlclZhbHVlcyA9IF9nZXRXcmFwcGVyVmFsdWVzKCRpbnB1dCk7XHJcbiAgICAgICAgICAgICAgICAkaW5wdXQucGFyZW50KCkuYXBwZW5kKCR3cmFwcGVyVmFsdWVzKTtcclxuICAgICAgICAgICAgICAgICRpbnB1dC5jc3MoXCJtYXJnaW4tYm90dG9tXCIsIFwiMHB4XCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICRpbnB1dC5vZmYoKS5vbihcImtleWRvd25cIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IHNldHRpbmdzLmtleUNvZGVDcmVhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJC50cmltKCRpbnB1dC52YWwoKSkgIT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlZyA9IF9idWlsZFJlZ0V4cChzZXR0aW5ncy5zZXBhcmF0b3JzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b2tlbnMgPSAkaW5wdXQudmFsKCkuc3BsaXQocmVnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnRyb2xhbW9zIG1heF9pbnB1dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLm1heF9pbnB1dCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbnMgPSB0b2tlbnMuc3BsaWNlKDAsIHNldHRpbmdzLm1heF9pbnB1dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRva2VucyA9IF9nZXRWYWx1ZXMoKS5jb25jYXQodG9rZW5zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaG93TWF4ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnRyb2xhbW9zIG1heF9hbGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5tYXhfYWxsID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsZW4gPSB0b2tlbnMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VucyA9IHRva2Vucy5zcGxpY2UoMCwgc2V0dGluZ3MubWF4X2FsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxlbiAhPSB0b2tlbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dNYXggPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNldHRpbmdzLnJlcGVhdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VucyA9IF91bmlxdWVBcnJheSh0b2tlbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wcmludFRva2Vucyh0b2tlbnMsICR3cmFwcGVyVmFsdWVzLCBzZXR0aW5ncyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNob3dNYXgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3Nob3dNYXhBbGwoJHdyYXBwZXJWYWx1ZXMsIHNldHRpbmdzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkaW5wdXQudmFsKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvL0FOT1RIRVIgUkVRVUVTVFxyXG4gICAgICAgICAgICBzd2l0Y2goYXJndW1lbnRzWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiZ2V0XCI6XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwidmFsXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgLy9nZXQgdmFsdWVcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX29wZXJhdGlvbnMuZ2V0KGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwic2V0XCI6XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiaW5wdXRcIjpcclxuICAgICAgICAgICAgICAgICAgICAvL3NldCB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfb3BlcmF0aW9ucy5zZXQoYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJkZWxcIjpcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJkZWxldGVcIjpcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJybVwiOlxyXG4gICAgICAgICAgICAgICAgY2FzZSBcInJlbW92ZVwiOlxyXG4gICAgICAgICAgICAgICAgICAgIC8vcmVtb3ZlIHZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9vcGVyYXRpb25zLmRlbChhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPcGNpw7NuICdcIisgYXJndW1lbnRzWzBdICtcIicgbm8gdsOhbGlkYVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy9TRVRUSU5HU1xyXG4gICAgJC5mbi50b2tlbml6ZXIuZGVmYXVsdHMgPSB7XHJcbiAgICAgICAgc2VwYXJhdG9yczogW1wiLFwiLCBcIjtcIl0sXHJcbiAgICAgICAga2V5Q29kZUNyZWF0ZTogJC50b2tlbml6ZXIuS0VZX0NPREUuRU5URVIsXHJcbiAgICAgICAgcmVwZWF0OiBmYWxzZSxcclxuICAgICAgICBtYXhfYWxsOiAwLFxyXG4gICAgICAgIG1heF9pbnB1dDogMCxcclxuICAgICAgICB0ZXh0OiB7XHJcbiAgICAgICAgICAgIG1heF9hbGw6IFwiTcOheGltbyBhbGNhbnphZG9cIlxyXG4gICAgICAgIH0sIFxyXG4gICAgICAgIG9uQ2xpY2tUb2tlbjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKFwidG9rZW5pemVyLXRva2VuLWFjdGl2ZVwiKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uRGVsZXRlVG9rZW46IGZ1bmN0aW9uICgpIHsgfVxyXG4gICAgfTsgXHJcblxyXG59KShqUXVlcnkpO1xyXG5cclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9