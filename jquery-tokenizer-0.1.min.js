!function(e){"use strict";e.tokenizer=e.tk={version:"0.1"},e.fn.tokenizer=e.fn.tk=function(){var t=this,n=13,r=46,a=8,o=function(e){for(var t=e.concat(),n=0;n<t.length;++n)for(var r=n+1;r<t.length;++r)t[n]===t[r]&&t.splice(r--,1);return t};String.__format||(String.__format=function(){for(var e=arguments[0],t=0;t<arguments.length-1;t++){var n=new RegExp("\\{"+t+"\\}","gm");e=e.replace(n,arguments[t+1])}return e});var i=function(t){var n=e("<div></div>").addClass("tokenizer-values").width(t.width()-7);return n},s=function(){e(".tokenizer-token").remove()},u=function(t){t.each(function(){e(this).remove()})},l=function(t){var n=e("<span></span>").addClass("tokenizer-token").text(t).attr("data-value",t).prepend(e("<span></span>").addClass("tokenizer-token-close").text("x"));return n.on("click",function(){e(this).toggleClass("tokenizer-token-active")}),n.find("span").on("click",function(){u(n)}),n},c=function(t){var n=l(e.fn.tokenizer.defaults.lang.max_all);n.addClass("tokenizer-token-max"),n.removeAttr("data-value"),t.append(n),setTimeout(function(){u(n)},1500)},g=function(){var t=[];return e(".tokenizer-token[data-value]").each(function(){t.push(e(this).attr("data-value"))}),t};if(!arguments.length||e.isPlainObject(arguments[0])){var d=arguments.length?arguments[0]:{};return e(document).on("keydown",function(t){(t.keyCode==r||t.keyCode==a)&&u(e(".tokenizer-token-active"))}),d=e.extend({},e.fn.tokenizer.defaults,d),t.each(function(){var t=e(this);console.log(t);var r=e("<div></div>").addClass("tokenizer-wrapper").width(t.width());t.wrap(r);var a=i(t);t.parent().append(a),t.css("margin-bottom","0px"),t.off().on("keypress",function(r){if(r.keyCode==n){if(r.preventDefault(),""!=e.trim(t.val())){for(var i="s*[",u=0;u<d.characters.length;u++)i+=d.characters[u];i+="]s*";var f=new RegExp(i),m=t.val().split(f);d.max_input>0&&(m=m.splice(0,d.max_input));var m=g().concat(m),v=!1;if(d.max_all>0){var p=m.length;m=m.splice(0,d.max_all),p!=m.length&&(v=!0)}d.repeat||(m=o(m)),s(),e.each(m,function(t,n){n=e.trim(n),a.append(l(n))}),v&&c(a)}t.val("")}})})}switch(arguments[0]){case"get":case"val":if(arguments.length>1)throw new Error("Número de argumentos inválidos, se requiere ('option') solamente");return g();case"set":case"input":if(2!=arguments.length)throw new Error("Número de argumentos inválidos, se requiere ('option', String|Array)");if("string"==typeof arguments[1])t.val(arguments[1]),t.trigger(e.Event("keypress",{keyCode:n}));else{if(!(arguments[1]instanceof Array))throw new Error("Segundo parámetro inválido, se requiere ('option', String|Array)");var f=arguments[1].join(e.fn.tokenizer.defaults.characters[0]);t.val(f),t.trigger(e.Event("keypress",{keyCode:n}))}return t;case"del":case"delete":case"rm":case"remove":if(2!=arguments.length)throw new Error("Número de argumentos inválidos, se requiere ('option', String)");if("string"!=typeof arguments[1])throw new Error("Segundo parámetro inválido, se requiere ('option', String)");return e(".tokenizer-token[data-value='"+arguments[1]+"']").remove(),t;default:throw new Error(String.__format("Opción '{0}' no válida",arguments[0]))}},e.fn.tokenizer.defaults=e.fn.tk.defaults={characters:[",",";"],repeat:!1,max_all:0,max_input:0,lang:{max_all:"Máximo alcanzado"}}}(jQuery);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS10b2tlbml6ZXItMC4xLmpzIl0sIm5hbWVzIjpbIiQiLCJ0b2tlbml6ZXIiLCJ0ayIsInZlcnNpb24iLCJmbiIsIiR0aGlzIiwidGhpcyIsIktFWV9DT0RFX0VOVEVSIiwiS0VZX0NPREVfU1VQUiIsIktFWV9DT0RFX0RFTCIsInVuaXF1ZUFycmF5IiwiYXJyYXkiLCJhIiwiY29uY2F0IiwiaSIsImxlbmd0aCIsImoiLCJzcGxpY2UiLCJTdHJpbmciLCJfX2Zvcm1hdCIsInMiLCJhcmd1bWVudHMiLCJyZWciLCJSZWdFeHAiLCJyZXBsYWNlIiwiZ2V0V3JhcHBlclZhbHVlcyIsIiRpbnB1dCIsIiR3cmFwcGVyVmFsdWVzIiwiYWRkQ2xhc3MiLCJ3aWR0aCIsInJlbW92ZUFsbFRva2VuIiwicmVtb3ZlIiwicmVtb3ZlVG9rZW4iLCIkdG9rZW5zIiwiZWFjaCIsImdldFRva2VuIiwidmFsdWUiLCIkdG9rZW4iLCJ0ZXh0IiwiYXR0ciIsInByZXBlbmQiLCJvbiIsInRvZ2dsZUNsYXNzIiwiZmluZCIsInNob3dNYXhBbGwiLCJkZWZhdWx0cyIsImxhbmciLCJtYXhfYWxsIiwicmVtb3ZlQXR0ciIsImFwcGVuZCIsInNldFRpbWVvdXQiLCJnZXRWYWx1ZXMiLCJ0b2tlbnMiLCJwdXNoIiwiaXNQbGFpbk9iamVjdCIsInNldHRpbmdzIiwiZG9jdW1lbnQiLCJlIiwia2V5Q29kZSIsImV4dGVuZCIsImNvbnNvbGUiLCJsb2ciLCIkd3JhcHBlciIsIndyYXAiLCJwYXJlbnQiLCJjc3MiLCJvZmYiLCJwcmV2ZW50RGVmYXVsdCIsInRyaW0iLCJ2YWwiLCJzdHJSZWciLCJjaGFyYWN0ZXJzIiwic3BsaXQiLCJtYXhfaW5wdXQiLCJzaG93TWF4IiwibGVuIiwicmVwZWF0IiwiayIsImVsIiwiRXJyb3IiLCJ0cmlnZ2VyIiwiRXZlbnQiLCJBcnJheSIsInN0ciIsImpvaW4iLCJqUXVlcnkiXSwibWFwcGluZ3MiOiJDQVFDLFNBQVdBLEdBQ1IsWUFFQUEsR0FB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SSxHQUFNOUQsVUFBVSxHQUFHK0QsS0FBS3BGLEVBQUVJLEdBQUdILFVBQVU0QyxTQUFTMEIsV0FBVyxHQUMvRGxFLEdBQU1nRSxJQUFJYyxHQUNWOUUsRUFBTTJFLFFBQVFoRixFQUFFaUYsTUFBTSxZQUFjdkIsUUFBU25ELEtBSWpELE1BQU9GLEVBQ1gsS0FBSyxNQUNMLElBQUssU0FDTCxJQUFLLEtBQ0wsSUFBSyxTQUVELEdBQXdCLEdBQXBCZ0IsVUFBVU4sT0FDVixLQUFNLElBQUlnRSxPQUFNLGlFQUVwQixJQUE0QixnQkFBakIxRCxXQUFVLEdBR2pCLEtBQU0sSUFBSTBELE9BQU0sNkRBRXBCLE9BSkkvRSxHQUFFLGdDQUFrQ3FCLFVBQVUsR0FBSyxNQUFNVSxTQUl0RDFCLENBQ1gsU0FDSSxLQUFNLElBQUkwRSxPQUFNN0QsT0FBT0MsU0FBUyx5QkFBMEJFLFVBQVUsT0FNcEZyQixFQUFFSSxHQUFHSCxVQUFVNEMsU0FBVzdDLEVBQUVJLEdBQUdGLEdBQUcyQyxVQUM5QjBCLFlBQWEsSUFBSyxLQUNsQkssUUFBUSxFQUNSN0IsUUFBUyxFQUNUMEIsVUFBVyxFQUNYM0IsTUFDSUMsUUFBUyxzQkFJbEJzQyIsImZpbGUiOiJqcXVlcnktdG9rZW5pemVyLTAuMS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiAganF1ZXJ5LXRva2VuaXplciAtIHYwLjFcbiAqICBBIGpRdWVyeSB0b29sIHRvIHRva2VuaXplciB2YWx1ZSBvbiBpbnB1dFxuICogIGh0dHBzOi8vZ2l0aHViLmNvbS9sbWZyZXNuZWRhL2pxdWVyeS10b2tlbml6ZXJcbiAqXG4gKiAgTWFkZSBieSBMdWlzIE1pZ3VlbCBGLlxuICogIFVuZGVyIE1JVCBMaWNlbnNlIChodHRwczovL2dpdGh1Yi5jb20vbG1mcmVzbmVkYS9qcXVlcnktdG9rZW5pemVyL2Jsb2IvbWFzdGVyL0xJQ0VOU0UpXG4gKi9cbjsoZnVuY3Rpb24gKCQpIHsgXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAkLnRva2VuaXplciA9ICQudGsgPSB7XG4gICAgICAgIHZlcnNpb246IFwiMC4xXCJcbiAgICB9O1xuXG4gICAgJC5mbi50b2tlbml6ZXIgPSAkLmZuLnRrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgJHRoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgS0VZX0NPREVfRU5URVIgPSAxMyxcbiAgICAgICAgICAgIEtFWV9DT0RFX1NVUFIgPSA0NixcbiAgICAgICAgICAgIEtFWV9DT0RFX0RFTCA9IDg7XG4gICAgICAgIHZhciB1bmlxdWVBcnJheSA9IGZ1bmN0aW9uIChhcnJheSkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IGFycmF5LmNvbmNhdCgpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGEubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSBpICsgMTsgaiA8IGEubGVuZ3RoOyArK2opIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYVtpXSA9PT0gYVtqXSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgYS5zcGxpY2Uoai0tLCAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gYTtcclxuICAgICAgICB9XG4gICAgICAgIGlmICghU3RyaW5nLl9fZm9ybWF0KSB7XHJcbiAgICAgICAgICAgIFN0cmluZy5fX2Zvcm1hdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aCAtIDE7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKFwiXFxcXHtcIiArIGkgKyBcIlxcXFx9XCIsIFwiZ21cIik7XG4gICAgICAgICAgICAgICAgICAgIHMgPSBzLnJlcGxhY2UocmVnLCBhcmd1bWVudHNbaSArIDFdKTtcclxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcztcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XG4gICAgICAgIHZhciBnZXRXcmFwcGVyVmFsdWVzID0gZnVuY3Rpb24gKCRpbnB1dCkge1xyXG4gICAgICAgICAgICB2YXIgJHdyYXBwZXJWYWx1ZXMgPSAkKFwiPGRpdj48L2Rpdj5cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJ0b2tlbml6ZXItdmFsdWVzXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLndpZHRoKCRpbnB1dC53aWR0aCgpIC0gNyk7XG4gICAgICAgICAgICByZXR1cm4gJHdyYXBwZXJWYWx1ZXM7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlbW92ZUFsbFRva2VuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKFwiLnRva2VuaXplci10b2tlblwiKS5yZW1vdmUoKTtcclxuICAgICAgICB9XG4gICAgICAgIHZhciByZW1vdmVUb2tlbiA9IGZ1bmN0aW9uKCR0b2tlbnMpIHtcclxuICAgICAgICAgICAgJHRva2Vucy5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZ2V0VG9rZW4gPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyICR0b2tlbiA9ICQoXCI8c3Bhbj48L3NwYW4+XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKFwidG9rZW5pemVyLXRva2VuXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHQodmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkYXRhLXZhbHVlXCIsIHZhbHVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5wcmVwZW5kKCQoXCI8c3Bhbj48L3NwYW4+XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKFwidG9rZW5pemVyLXRva2VuLWNsb3NlXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHQoXCJ4XCIpKTtcbiAgICAgICAgICAgICR0b2tlbi5vbihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICQodGhpcykudG9nZ2xlQ2xhc3MoXCJ0b2tlbml6ZXItdG9rZW4tYWN0aXZlXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkdG9rZW4uZmluZChcInNwYW5cIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVUb2tlbigkdG9rZW4pO1xyXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiAkdG9rZW47ICBcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2hvd01heEFsbCA9IGZ1bmN0aW9uICgkd3JhcHBlclZhbHVlcykge1xyXG4gICAgICAgICAgICB2YXIgJHRva2VuID0gZ2V0VG9rZW4oJC5mbi50b2tlbml6ZXIuZGVmYXVsdHMubGFuZy5tYXhfYWxsKTtcbiAgICAgICAgICAgICR0b2tlbi5hZGRDbGFzcyhcInRva2VuaXplci10b2tlbi1tYXhcIik7XG4gICAgICAgICAgICAkdG9rZW4ucmVtb3ZlQXR0cihcImRhdGEtdmFsdWVcIik7XG4gICAgICAgICAgICAkd3JhcHBlclZhbHVlcy5hcHBlbmQoJHRva2VuKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVUb2tlbigkdG9rZW4pO1xuICAgICAgICAgICAgfSwgMTUwMClcbiAgICAgICAgfVxuICAgICAgICB2YXIgZ2V0VmFsdWVzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciB0b2tlbnMgPSBbXTtcbiAgICAgICAgICAgICQoXCIudG9rZW5pemVyLXRva2VuW2RhdGEtdmFsdWVdXCIpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdG9rZW5zLnB1c2goJCh0aGlzKS5hdHRyKFwiZGF0YS12YWx1ZVwiKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0b2tlbnM7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGggfHwgJC5pc1BsYWluT2JqZWN0KGFyZ3VtZW50c1swXSkpIHtcclxuICAgICAgICAgICAgLy9iaW5kXHJcbiAgICAgICAgICAgIHZhciBzZXR0aW5ncyA9ICFhcmd1bWVudHMubGVuZ3RoID8ge30gOiBhcmd1bWVudHNbMF07XHJcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKFwia2V5ZG93blwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSBLRVlfQ09ERV9TVVBSIHx8IGUua2V5Q29kZSA9PSBLRVlfQ09ERV9ERUwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZW1vdmVUb2tlbigkKFwiLnRva2VuaXplci10b2tlbi1hY3RpdmVcIikpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXG4gICAgICAgICAgICBzZXR0aW5ncyA9ICQuZXh0ZW5kKHt9LCAkLmZuLnRva2VuaXplci5kZWZhdWx0cywgc2V0dGluZ3MpO1xuICAgICAgICAgICAgXG5cbiAgICAgICAgICAgIHJldHVybiAkdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciAkaW5wdXQgPSAkKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJGlucHV0KTtcbiAgICAgICAgICAgICAgICB2YXIgJHdyYXBwZXIgPSAkKFwiPGRpdj48L2Rpdj5cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKFwidG9rZW5pemVyLXdyYXBwZXJcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLndpZHRoKCRpbnB1dC53aWR0aCgpKTtcbiAgICAgICAgICAgICAgICAkaW5wdXQud3JhcCgkd3JhcHBlcik7XG4gICAgICAgICAgICAgICAgdmFyICR3cmFwcGVyVmFsdWVzID0gZ2V0V3JhcHBlclZhbHVlcygkaW5wdXQpO1xuICAgICAgICAgICAgICAgICRpbnB1dC5wYXJlbnQoKS5hcHBlbmQoJHdyYXBwZXJWYWx1ZXMpO1xuICAgICAgICAgICAgICAgICRpbnB1dC5jc3MoXCJtYXJnaW4tYm90dG9tXCIsIFwiMHB4XCIpO1xuICAgICAgICAgICAgICAgICRpbnB1dC5vZmYoKS5vbihcImtleXByZXNzXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSBLRVlfQ09ERV9FTlRFUikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkLnRyaW0oJGlucHV0LnZhbCgpKSAhPSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RyUmVnID0gXCJcXHMqW1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZXR0aW5ncy5jaGFyYWN0ZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyUmVnICs9IHNldHRpbmdzLmNoYXJhY3RlcnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJSZWcgKz0gXCJdXFxzKlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoc3RyUmVnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b2tlbnMgPSAkaW5wdXQudmFsKCkuc3BsaXQocmVnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnRyb2xhbW9zIG1heF9pbnB1dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLm1heF9pbnB1dCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbnMgPSB0b2tlbnMuc3BsaWNlKDAsIHNldHRpbmdzLm1heF9pbnB1dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRva2VucyA9IGdldFZhbHVlcygpLmNvbmNhdCh0b2tlbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNob3dNYXggPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29udHJvbGFtb3MgbWF4X2FsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLm1heF9hbGwgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxlbiA9IHRva2Vucy5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5zID0gdG9rZW5zLnNwbGljZSgwLCBzZXR0aW5ncy5tYXhfYWxsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGVuICE9IHRva2Vucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd01heCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2V0dGluZ3MucmVwZWF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5zID0gdW5pcXVlQXJyYXkodG9rZW5zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVBbGxUb2tlbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKHRva2VucywgZnVuY3Rpb24gKGssIGVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwgPSAkLnRyaW0oZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR3cmFwcGVyVmFsdWVzLmFwcGVuZChnZXRUb2tlbihlbCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hvd01heClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93TWF4QWxsKCR3cmFwcGVyVmFsdWVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkaW5wdXQudmFsKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICBzd2l0Y2goYXJndW1lbnRzWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiZ2V0XCI6XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwidmFsXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgLy9nZXQgdmFsdWVcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTsO6bWVybyBkZSBhcmd1bWVudG9zIGludsOhbGlkb3MsIHNlIHJlcXVpZXJlICgnb3B0aW9uJykgc29sYW1lbnRlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0VmFsdWVzKCk7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwic2V0XCI6XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiaW5wdXRcIjpcclxuICAgICAgICAgICAgICAgICAgICAvL3NldCB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoICE9IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTsO6bWVybyBkZSBhcmd1bWVudG9zIGludsOhbGlkb3MsIHNlIHJlcXVpZXJlICgnb3B0aW9uJywgU3RyaW5nfEFycmF5KVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmd1bWVudHNbMV0gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9vbmx5IGlucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLnZhbChhcmd1bWVudHNbMV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy50cmlnZ2VyKCQuRXZlbnQoXCJrZXlwcmVzc1wiLCB7IGtleUNvZGU6IEtFWV9DT0RFX0VOVEVSIH0pKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFyZ3VtZW50c1sxXSBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vYXJyYXkgaW5wdXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9IGFyZ3VtZW50c1sxXS5qb2luKCQuZm4udG9rZW5pemVyLmRlZmF1bHRzLmNoYXJhY3RlcnNbMF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy52YWwoc3RyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMudHJpZ2dlcigkLkV2ZW50KFwia2V5cHJlc3NcIiwgeyBrZXlDb2RlOiBLRVlfQ09ERV9FTlRFUiB9KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2VndW5kbyBwYXLDoW1ldHJvIGludsOhbGlkbywgc2UgcmVxdWllcmUgKCdvcHRpb24nLCBTdHJpbmd8QXJyYXkpXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXM7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiZGVsXCI6XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiZGVsZXRlXCI6XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwicm1cIjpcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJyZW1vdmVcIjpcclxuICAgICAgICAgICAgICAgICAgICAvL3JlbW92ZSB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoICE9IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTsO6bWVybyBkZSBhcmd1bWVudG9zIGludsOhbGlkb3MsIHNlIHJlcXVpZXJlICgnb3B0aW9uJywgU3RyaW5nKVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmd1bWVudHNbMV0gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIi50b2tlbml6ZXItdG9rZW5bZGF0YS12YWx1ZT0nXCIgKyBhcmd1bWVudHNbMV0gKyBcIiddXCIpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlNlZ3VuZG8gcGFyw6FtZXRybyBpbnbDoWxpZG8sIHNlIHJlcXVpZXJlICgnb3B0aW9uJywgU3RyaW5nKVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoU3RyaW5nLl9fZm9ybWF0KFwiT3BjacOzbiAnezB9JyBubyB2w6FsaWRhXCIsIGFyZ3VtZW50c1swXSkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgJC5mbi50b2tlbml6ZXIuZGVmYXVsdHMgPSAkLmZuLnRrLmRlZmF1bHRzID0ge1xuICAgICAgICBjaGFyYWN0ZXJzOiBbXCIsXCIsIFwiO1wiXSxcbiAgICAgICAgcmVwZWF0OiBmYWxzZSxcbiAgICAgICAgbWF4X2FsbDogMCxcbiAgICAgICAgbWF4X2lucHV0OiAwLFxuICAgICAgICBsYW5nOiB7XHJcbiAgICAgICAgICAgIG1heF9hbGw6IFwiTcOheGltbyBhbGNhbnphZG9cIlxyXG4gICAgICAgIH1cbiAgICB9O1xuXG59KShqUXVlcnkpO1xuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=