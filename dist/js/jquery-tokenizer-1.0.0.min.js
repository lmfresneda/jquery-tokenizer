"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?e(require("jquery"),window,document):e(jQuery,window,document)}(function(e,t,n,o){e.tokenizer={version:"1.0",KEY_CODE:{ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_TOP:38,BACKSPACE:32,COMMA:188,CTRL:17,DEL:8,DOT:190,ENTER:13,ESC:27,SHIFT:16,SUPR:46,TAB:9}},e.fn.tokenizer=function(){function t(e){var t=e.filter(function(t,n){return e.indexOf(t)===n});return t}function o(t){var n=e("<div></div>").addClass("tokenizer-values").width(t.width()-7);return n}function r(t){e(".tokenizer-token",t.parent()).remove()}function i(t){t.each(function(){e(this).remove()})}function a(t,n){var o=e("<span></span>").addClass("tokenizer-token").text(t).attr("data-value",t).prepend(e("<span></span>").addClass("tokenizer-token-close").text("x"));return o.on("click",n.onClickToken),o.find("span").on("click",function(){return i(o)}),o}function u(t,n){var o=a(e.fn.tokenizer.defaults.text.max_all,n);o.addClass("tokenizer-token-max"),o.removeAttr("data-value"),t.append(o),setTimeout(function(){i(o)},1500)}function s(t){var n=[];return e(".tokenizer-token[data-value]",t.parent()).each(function(){n.push(e(this).attr("data-value"))}),n}function l(e){var t="["+e.map(function(e){return e}).join("")+"]";return new RegExp(t)}function f(e,t,n,o){r(e),t.forEach(function(e){if(e.trim()){var t=a(e,o);n.append(t)}})}var d=this,c={get:function(e){if(e.length>1)throw new Error("Número de argumentos inválidos, se requiere ('option') solamente");return s(d)},set:function(t){var n;if(2!=t.length)throw new Error("Número de argumentos inválidos, se requiere ('option', String|Array)");if("string"==typeof t[1])n=t[1];else{if(!(t[1]instanceof Array))throw new Error("Segundo parámetro inválido, se requiere ('option', String|Array)");n=t[1].join(e.fn.tokenizer.defaults.separators[0])}return d.val(n),d.trigger(e.Event("keydown",{keyCode:e.tokenizer.KEY_CODE.ENTER})),d},del:function(t){if(2!=t.length)throw new Error("Número de argumentos inválidos, se requiere ('option', String)");if("string"!=typeof t[1])throw new Error("Segundo parámetro inválido, se requiere ('option', String)");return i(e(".tokenizer-token[data-value='"+t[1]+"']")),d}};if(!arguments.length||e.isPlainObject(arguments[0])){var p=arguments.length?arguments[0]:{};return e(n).on("keydown",function(t){if(t.keyCode==e.tokenizer.KEY_CODE.SUPR){var n=e(".tokenizer-token-active");i(e(".tokenizer-token-active")),e.fn.tokenizer.defaults.onDeleteToken(n)}}),p=e.extend({},e.fn.tokenizer.defaults,p),d.each(function(){var n=e(this),r=e("<div></div>").addClass("tokenizer-wrapper").width(n.width());n.wrap(r);var i=o(n);n.parent().append(i),n.css("margin-bottom","0px"),n.off().on("keydown",function(e){if(e.keyCode==p.keyCodeCreate){if(e.preventDefault(),n.val().trim()){var o=l(p.separators),r=n.val().split(o);p.max_input&&(r=r.splice(0,p.max_input));var r=s(n).concat(r),a=!1;if(p.max_all>0){var d=r.length;r=r.splice(0,p.max_all),d!=r.length&&(a=!0)}p.repeat||(r=t(r)),f(n,r,i,p),a&&u(i,p)}n.val("")}})})}switch(arguments[0]){case"get":case"val":return c.get(arguments);case"set":case"input":return c.set(arguments);case"del":case"delete":case"rm":case"remove":return c.del(arguments);default:throw new Error("Opción '"+arguments[0]+"' no válida")}},e.fn.tokenizer.defaults={separators:[",",";"],keyCodeCreate:e.tokenizer.KEY_CODE.ENTER,repeat:!1,max_all:0,max_input:0,text:{max_all:"Máximo alcanzado"},onClickToken:function(){e(this).toggleClass("tokenizer-token-active")},onDeleteToken:function(){}}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS10b2tlbml6ZXItMS4wLjAuanMiXSwibmFtZXMiOlsiX3R5cGVvZiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwib2JqIiwiY29uc3RydWN0b3IiLCJwcm90b3R5cGUiLCJmYWN0b3J5IiwibW9kdWxlIiwiZXhwb3J0cyIsInJlcXVpcmUiLCJ3aW5kb3ciLCJkb2N1bWVudCIsImpRdWVyeSIsIiQiLCJ1bmRlZmluZWQiLCJ0b2tlbml6ZXIiLCJ2ZXJzaW9uIiwiS0VZX0NPREUiLCJBUlJPV19ET1dOIiwiQVJST1dfTEVGVCIsIkFSUk9XX1JJR0hUIiwiQVJST1dfVE9QIiwiQkFDS1NQQUNFIiwiQ09NTUEiLCJDVFJMIiwiREVMIiwiRE9UIiwiRU5URVIiLCJFU0MiLCJTSElGVCIsIlNVUFIiLCJUQUIiLCJmbiIsIl91bmlxdWVBcnJheSIsImFycmF5IiwibmV3QXJyYXkiLCJmaWx0ZXIiLCJlbGVtIiwiaW5kZXgiLCJpbmRleE9mIiwiX2dldFdyYXBwZXJWYWx1ZXMiLCIkaW5wdXQiLCIkd3JhcHBlclZhbHVlcyIsImFkZENsYXNzIiwid2lkdGgiLCJfcmVtb3ZlQWxsVG9rZW4iLCJwYXJlbnQiLCJyZW1vdmUiLCJfcmVtb3ZlVG9rZW4iLCIkdG9rZW5zIiwiZWFjaCIsInRoaXMiLCJfZ2V0VG9rZW4iLCJ2YWx1ZSIsInNldHRpbmdzIiwiJHRva2VuIiwidGV4dCIsImF0dHIiLCJwcmVwZW5kIiwib24iLCJvbkNsaWNrVG9rZW4iLCJmaW5kIiwiX3Nob3dNYXhBbGwiLCJkZWZhdWx0cyIsIm1heF9hbGwiLCJyZW1vdmVBdHRyIiwiYXBwZW5kIiwic2V0VGltZW91dCIsIl9nZXRWYWx1ZXMiLCJ0b2tlbnMiLCJwdXNoIiwiX2J1aWxkUmVnRXhwIiwic2VwYXJhdG9ycyIsInN0clJlZyIsIm1hcCIsInNlcCIsImpvaW4iLCJSZWdFeHAiLCJfcHJpbnRUb2tlbnMiLCJmb3JFYWNoIiwidG9rZW4iLCJ0cmltIiwiJHRoaXMiLCJfb3BlcmF0aW9ucyIsImdldCIsImFyZ3MiLCJsZW5ndGgiLCJFcnJvciIsInNldCIsInN0ciIsIkFycmF5IiwidmFsIiwidHJpZ2dlciIsIkV2ZW50Iiwia2V5Q29kZSIsImRlbCIsImFyZ3VtZW50cyIsImlzUGxhaW5PYmplY3QiLCJlIiwiJGVsZW1zIiwib25EZWxldGVUb2tlbiIsImV4dGVuZCIsIiR3cmFwcGVyIiwid3JhcCIsImNzcyIsIm9mZiIsImtleUNvZGVDcmVhdGUiLCJwcmV2ZW50RGVmYXVsdCIsInJlZyIsInNwbGl0IiwibWF4X2lucHV0Iiwic3BsaWNlIiwiY29uY2F0Iiwic2hvd01heCIsImxlbiIsInJlcGVhdCIsInRvZ2dsZUNsYXNzIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUVBLElBQUlBLFNBQTRCLGtCQUFYQyxTQUFvRCxnQkFBcEJBLFFBQU9DLFNBQXdCLFNBQVVDLEdBQU8sYUFBY0EsSUFBUyxTQUFVQSxHQUFPLE1BQU9BLElBQXlCLGtCQUFYRixTQUF5QkUsRUFBSUMsY0FBZ0JILFFBQVVFLElBQVFGLE9BQU9JLFVBQVksZUFBa0JGLEtBVXRRLFNBQVdHLEdBQytELFlBQWpELG1CQUFYQyxRQUF5QixZQUFjUCxRQUFRTyxVQUFxRCxXQUE1QlAsUUFBUU8sT0FBT0MsU0FDakdGLEVBQVFHLFFBQVEsVUFBV0MsT0FBUUMsVUFFbkNMLEVBQVFNLE9BQVFGLE9BQVFDLFdBRXpCLFNBQVVFLEVBQUdILEVBQVFDLEVBQVVHLEdBR2hDRCxFQUFFRSxXQUNBQyxRQUFTLE1BQ1RDLFVBQ0VDLFdBQVksR0FDWkMsV0FBWSxHQUNaQyxZQUFhLEdBQ2JDLFVBQVcsR0FDWEMsVUFBVyxHQUNYQyxNQUFPLElBQ1BDLEtBQU0sR0FDTkMsSUFBSyxFQUNMQyxJQUFLLElBQ0xDLE1BQU8sR0FDUEMsSUFBSyxHQUNMQyxNQUFPLEdBQ1BDLEtBQU0sR0FDTkMsSUFBSyxJQUlUbEIsRUFBRW1CLEdBQUdqQixVQUFZLFdBSWYsUUFBU2tCLEdBQWFDLEdBQ3BCLEdBQUlDLEdBQVdELEVBQU1FLE9BQU8sU0FBVUMsRUFBTUMsR0FD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QixJQUFLLE1BQ0wsSUFBSyxNQUVILE1BQU9iLEdBQVlDLElBQUlZLFVBQ3pCLEtBQUssTUFDTCxJQUFLLFFBRUgsTUFBT2IsR0FBWUssSUFBSVEsVUFDekIsS0FBSyxNQUNMLElBQUssU0FDTCxJQUFLLEtBQ0wsSUFBSyxTQUVILE1BQU9iLEdBQVlZLElBQUlDLFVBQ3pCLFNBQ0UsS0FBTSxJQUFJVCxPQUFNLFdBQWdCUyxVQUFVLEdBQUssaUJBTXZEbkYsRUFBRW1CLEdBQUdqQixVQUFVZ0QsVUFDYlMsWUFBYSxJQUFLLEtBQ2xCa0MsY0FBZTdGLEVBQUVFLFVBQVVFLFNBQVNVLE1BQ3BDd0YsUUFBUSxFQUNSbkQsUUFBUyxFQUNUOEMsVUFBVyxFQUNYdEQsTUFDRVEsUUFBUyxvQkFFWEosYUFBYyxXQUNaL0MsRUFBRXNDLE1BQU1pRSxZQUFZLDJCQUV0QmhCLGNBQWUiLCJmaWxlIjoianF1ZXJ5LXRva2VuaXplci0xLjAuMC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbi8qXHJcbiAqICBqcXVlcnktdG9rZW5pemVyIC0gdjEuMFxyXG4gKiAgQSBqUXVlcnkgdG9vbCB0byB0b2tlbml6ZXIgdmFsdWUgb24gaW5wdXRcclxuICogIGh0dHBzOi8vZ2l0aHViLmNvbS9sbWZyZXNuZWRhL2pxdWVyeS10b2tlbml6ZXJcclxuICpcclxuICogIE1hZGUgYnkgTHVpcyBNaWd1ZWwgRi5cclxuICogIFVuZGVyIE1JVCBMaWNlbnNlIChodHRwczovL2dpdGh1Yi5jb20vbG1mcmVzbmVkYS9qcXVlcnktdG9rZW5pemVyL2Jsb2IvbWFzdGVyL0xJQ0VOU0UpXHJcbiAqL1xuKGZ1bmN0aW9uIChmYWN0b3J5KSB7XG4gIGlmICgodHlwZW9mIG1vZHVsZSA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKG1vZHVsZSkpID09PSBcIm9iamVjdFwiICYmIF90eXBlb2YobW9kdWxlLmV4cG9ydHMpID09PSBcIm9iamVjdFwiKSB7XG4gICAgZmFjdG9yeShyZXF1aXJlKFwianF1ZXJ5XCIpLCB3aW5kb3csIGRvY3VtZW50KTtcbiAgfSBlbHNlIHtcbiAgICBmYWN0b3J5KGpRdWVyeSwgd2luZG93LCBkb2N1bWVudCk7XG4gIH1cbn0pKGZ1bmN0aW9uICgkLCB3aW5kb3csIGRvY3VtZW50LCB1bmRlZmluZWQpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gICQudG9rZW5pemVyID0ge1xuICAgIHZlcnNpb246ICcxLjAnLFxuICAgIEtFWV9DT0RFOiB7XG4gICAgICBBUlJPV19ET1dOOiA0MCxcbiAgICAgIEFSUk9XX0xFRlQ6IDM3LFxuICAgICAgQVJST1dfUklHSFQ6IDM5LFxuICAgICAgQVJST1dfVE9QOiAzOCxcbiAgICAgIEJBQ0tTUEFDRTogMzIsXG4gICAgICBDT01NQTogMTg4LFxuICAgICAgQ1RSTDogMTcsXG4gICAgICBERUw6IDgsXG4gICAgICBET1Q6IDE5MCxcbiAgICAgIEVOVEVSOiAxMyxcbiAgICAgIEVTQzogMjcsXG4gICAgICBTSElGVDogMTYsXG4gICAgICBTVVBSOiA0NixcbiAgICAgIFRBQjogOVxuICAgIH1cbiAgfTtcblxuICAkLmZuLnRva2VuaXplciA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgJHRoaXMgPSB0aGlzO1xuXG4gICAgLy9QUklWQVRFIE1FVEhPRFNcbiAgICBmdW5jdGlvbiBfdW5pcXVlQXJyYXkoYXJyYXkpIHtcbiAgICAgIHZhciBuZXdBcnJheSA9IGFycmF5LmZpbHRlcihmdW5jdGlvbiAoZWxlbSwgaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIGFycmF5LmluZGV4T2YoZWxlbSkgPT09IGluZGV4O1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gbmV3QXJyYXk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIF9nZXRXcmFwcGVyVmFsdWVzKCRpbnB1dCkge1xuICAgICAgdmFyICR3cmFwcGVyVmFsdWVzID0gJCgnPGRpdj48L2Rpdj4nKS5hZGRDbGFzcygndG9rZW5pemVyLXZhbHVlcycpLndpZHRoKCRpbnB1dC53aWR0aCgpIC0gNyk7XG4gICAgICByZXR1cm4gJHdyYXBwZXJWYWx1ZXM7XG4gICAgfVxuICAgIGZ1bmN0aW9uIF9yZW1vdmVBbGxUb2tlbigkaW5wdXQpIHtcbiAgICAgICQoJy50b2tlbml6ZXItdG9rZW4nLCAkaW5wdXQucGFyZW50KCkpLnJlbW92ZSgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBfcmVtb3ZlVG9rZW4oJHRva2Vucykge1xuICAgICAgJHRva2Vucy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCh0aGlzKS5yZW1vdmUoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBfZ2V0VG9rZW4odmFsdWUsIHNldHRpbmdzKSB7XG4gICAgICB2YXIgJHRva2VuID0gJCgnPHNwYW4+PC9zcGFuPicpLmFkZENsYXNzKCd0b2tlbml6ZXItdG9rZW4nKS50ZXh0KHZhbHVlKS5hdHRyKCdkYXRhLXZhbHVlJywgdmFsdWUpLnByZXBlbmQoJCgnPHNwYW4+PC9zcGFuPicpLmFkZENsYXNzKCd0b2tlbml6ZXItdG9rZW4tY2xvc2UnKS50ZXh0KCd4JykpO1xuICAgICAgJHRva2VuLm9uKCdjbGljaycsIHNldHRpbmdzLm9uQ2xpY2tUb2tlbik7XG4gICAgICAkdG9rZW4uZmluZCgnc3BhbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9yZW1vdmVUb2tlbigkdG9rZW4pO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gJHRva2VuO1xuICAgIH1cbiAgICBmdW5jdGlvbiBfc2hvd01heEFsbCgkd3JhcHBlclZhbHVlcywgc2V0dGluZ3MpIHtcbiAgICAgIHZhciAkdG9rZW4gPSBfZ2V0VG9rZW4oJC5mbi50b2tlbml6ZXIuZGVmYXVsdHMudGV4dC5tYXhfYWxsLCBzZXR0aW5ncyk7XG4gICAgICAkdG9rZW4uYWRkQ2xhc3MoJ3Rva2VuaXplci10b2tlbi1tYXgnKTtcbiAgICAgICR0b2tlbi5yZW1vdmVBdHRyKCdkYXRhLXZhbHVlJyk7XG4gICAgICAkd3JhcHBlclZhbHVlcy5hcHBlbmQoJHRva2VuKTtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBfcmVtb3ZlVG9rZW4oJHRva2VuKTtcbiAgICAgIH0sIDE1MDApO1xuICAgIH1cbiAgICBmdW5jdGlvbiBfZ2V0VmFsdWVzKCRpbnB1dCkge1xuICAgICAgdmFyIHRva2VucyA9IFtdO1xuICAgICAgJCgnLnRva2VuaXplci10b2tlbltkYXRhLXZhbHVlXScsICRpbnB1dC5wYXJlbnQoKSkuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRva2Vucy5wdXNoKCQodGhpcykuYXR0cignZGF0YS12YWx1ZScpKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRva2VucztcbiAgICB9XG4gICAgZnVuY3Rpb24gX2J1aWxkUmVnRXhwKHNlcGFyYXRvcnMpIHtcbiAgICAgIHZhciBzdHJSZWcgPSBcIltcIiArIHNlcGFyYXRvcnMubWFwKGZ1bmN0aW9uIChzZXApIHtcbiAgICAgICAgcmV0dXJuIHNlcDtcbiAgICAgIH0pLmpvaW4oJycpICsgXCJdXCI7XG4gICAgICByZXR1cm4gbmV3IFJlZ0V4cChzdHJSZWcpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBfcHJpbnRUb2tlbnMoJGlucHV0LCB0b2tlbnMsICR3cmFwcGVyVmFsdWVzLCBzZXR0aW5ncykge1xuICAgICAgX3JlbW92ZUFsbFRva2VuKCRpbnB1dCk7XG4gICAgICB0b2tlbnMuZm9yRWFjaChmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgaWYgKHRva2VuLnRyaW0oKSkge1xuICAgICAgICAgIHZhciAkdG9rZW4gPSBfZ2V0VG9rZW4odG9rZW4sIHNldHRpbmdzKTtcbiAgICAgICAgICAkd3JhcHBlclZhbHVlcy5hcHBlbmQoJHRva2VuKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHZhciBfb3BlcmF0aW9ucyA9IHtcbiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KGFyZ3MpIHtcbiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID4gMSkgdGhyb3cgbmV3IEVycm9yKCdOw7ptZXJvIGRlIGFyZ3VtZW50b3MgaW52w6FsaWRvcywgc2UgcmVxdWllcmUgKFxcJ29wdGlvblxcJykgc29sYW1lbnRlJyk7XG5cbiAgICAgICAgcmV0dXJuIF9nZXRWYWx1ZXMoJHRoaXMpO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gc2V0KGFyZ3MpIHtcbiAgICAgICAgdmFyIHN0cjtcbiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoICE9IDIpIHRocm93IG5ldyBFcnJvcignTsO6bWVybyBkZSBhcmd1bWVudG9zIGludsOhbGlkb3MsIHNlIHJlcXVpZXJlIChcXCdvcHRpb25cXCcsIFN0cmluZ3xBcnJheSknKTtcblxuICAgICAgICBpZiAodHlwZW9mIGFyZ3NbMV0gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgLy9vbmx5IGlucHV0XG4gICAgICAgICAgc3RyID0gYXJnc1sxXTtcbiAgICAgICAgfSBlbHNlIGlmIChhcmdzWzFdIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAvL2FycmF5IGlucHV0XG4gICAgICAgICAgc3RyID0gYXJnc1sxXS5qb2luKCQuZm4udG9rZW5pemVyLmRlZmF1bHRzLnNlcGFyYXRvcnNbMF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2VndW5kbyBwYXLDoW1ldHJvIGludsOhbGlkbywgc2UgcmVxdWllcmUgKFxcJ29wdGlvblxcJywgU3RyaW5nfEFycmF5KScpO1xuICAgICAgICB9XG4gICAgICAgICR0aGlzLnZhbChzdHIpO1xuICAgICAgICAkdGhpcy50cmlnZ2VyKCQuRXZlbnQoJ2tleWRvd24nLCB7IGtleUNvZGU6ICQudG9rZW5pemVyLktFWV9DT0RFLkVOVEVSIH0pKTtcbiAgICAgICAgcmV0dXJuICR0aGlzO1xuICAgICAgfSxcbiAgICAgIGRlbDogZnVuY3Rpb24gZGVsKGFyZ3MpIHtcbiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoICE9IDIpIHRocm93IG5ldyBFcnJvcignTsO6bWVybyBkZSBhcmd1bWVudG9zIGludsOhbGlkb3MsIHNlIHJlcXVpZXJlIChcXCdvcHRpb25cXCcsIFN0cmluZyknKTtcblxuICAgICAgICBpZiAodHlwZW9mIGFyZ3NbMV0gPT09ICdzdHJpbmcnKSBfcmVtb3ZlVG9rZW4oJChcIi50b2tlbml6ZXItdG9rZW5bZGF0YS12YWx1ZT0nXCIgKyBhcmdzWzFdICsgXCInXVwiKSk7ZWxzZSB0aHJvdyBuZXcgRXJyb3IoJ1NlZ3VuZG8gcGFyw6FtZXRybyBpbnbDoWxpZG8sIHNlIHJlcXVpZXJlIChcXCdvcHRpb25cXCcsIFN0cmluZyknKTtcbiAgICAgICAgcmV0dXJuICR0aGlzO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGggfHwgJC5pc1BsYWluT2JqZWN0KGFyZ3VtZW50c1swXSkpIHtcbiAgICAgIC8vSU5JVCBCSU5ESU5HXG4gICAgICB2YXIgc2V0dGluZ3MgPSAhYXJndW1lbnRzLmxlbmd0aCA/IHt9IDogYXJndW1lbnRzWzBdO1xuICAgICAgJChkb2N1bWVudCkub24oJ2tleWRvd24nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoZS5rZXlDb2RlID09ICQudG9rZW5pemVyLktFWV9DT0RFLlNVUFIpIHtcbiAgICAgICAgICB2YXIgJGVsZW1zID0gJCgnLnRva2VuaXplci10b2tlbi1hY3RpdmUnKTtcbiAgICAgICAgICBfcmVtb3ZlVG9rZW4oJCgnLnRva2VuaXplci10b2tlbi1hY3RpdmUnKSk7XG4gICAgICAgICAgJC5mbi50b2tlbml6ZXIuZGVmYXVsdHMub25EZWxldGVUb2tlbigkZWxlbXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgc2V0dGluZ3MgPSAkLmV4dGVuZCh7fSwgJC5mbi50b2tlbml6ZXIuZGVmYXVsdHMsIHNldHRpbmdzKTtcblxuICAgICAgcmV0dXJuICR0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgJGlucHV0ID0gJCh0aGlzKTtcbiAgICAgICAgdmFyICR3cmFwcGVyID0gJCgnPGRpdj48L2Rpdj4nKS5hZGRDbGFzcygndG9rZW5pemVyLXdyYXBwZXInKS53aWR0aCgkaW5wdXQud2lkdGgoKSk7XG4gICAgICAgICRpbnB1dC53cmFwKCR3cmFwcGVyKTtcbiAgICAgICAgdmFyICR3cmFwcGVyVmFsdWVzID0gX2dldFdyYXBwZXJWYWx1ZXMoJGlucHV0KTtcbiAgICAgICAgJGlucHV0LnBhcmVudCgpLmFwcGVuZCgkd3JhcHBlclZhbHVlcyk7XG4gICAgICAgICRpbnB1dC5jc3MoJ21hcmdpbi1ib3R0b20nLCAnMHB4Jyk7XG5cbiAgICAgICAgJGlucHV0Lm9mZigpLm9uKCdrZXlkb3duJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IHNldHRpbmdzLmtleUNvZGVDcmVhdGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGlmICgkaW5wdXQudmFsKCkudHJpbSgpKSB7XG4gICAgICAgICAgICAgIHZhciByZWcgPSBfYnVpbGRSZWdFeHAoc2V0dGluZ3Muc2VwYXJhdG9ycyk7XG4gICAgICAgICAgICAgIHZhciB0b2tlbnMgPSAkaW5wdXQudmFsKCkuc3BsaXQocmVnKTtcblxuICAgICAgICAgICAgICAvL2NvbnRyb2xhbW9zIG1heF9pbnB1dFxuICAgICAgICAgICAgICBpZiAoc2V0dGluZ3MubWF4X2lucHV0KSB0b2tlbnMgPSB0b2tlbnMuc3BsaWNlKDAsIHNldHRpbmdzLm1heF9pbnB1dCk7XG5cbiAgICAgICAgICAgICAgdmFyIHRva2VucyA9IF9nZXRWYWx1ZXMoJGlucHV0KS5jb25jYXQodG9rZW5zKTtcbiAgICAgICAgICAgICAgdmFyIHNob3dNYXggPSBmYWxzZTtcbiAgICAgICAgICAgICAgLy9jb250cm9sYW1vcyBtYXhfYWxsXG4gICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5tYXhfYWxsID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBsZW4gPSB0b2tlbnMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHRva2VucyA9IHRva2Vucy5zcGxpY2UoMCwgc2V0dGluZ3MubWF4X2FsbCk7XG4gICAgICAgICAgICAgICAgaWYgKGxlbiAhPSB0b2tlbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICBzaG93TWF4ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoIXNldHRpbmdzLnJlcGVhdCkgdG9rZW5zID0gX3VuaXF1ZUFycmF5KHRva2Vucyk7XG5cbiAgICAgICAgICAgICAgX3ByaW50VG9rZW5zKCRpbnB1dCwgdG9rZW5zLCAkd3JhcHBlclZhbHVlcywgc2V0dGluZ3MpO1xuXG4gICAgICAgICAgICAgIGlmIChzaG93TWF4KSBfc2hvd01heEFsbCgkd3JhcHBlclZhbHVlcywgc2V0dGluZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJGlucHV0LnZhbCgnJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvL0FOT1RIRVIgUkVRVUVTVFxuICAgICAgc3dpdGNoIChhcmd1bWVudHNbMF0pIHtcbiAgICAgICAgY2FzZSAnZ2V0JzpcbiAgICAgICAgY2FzZSAndmFsJzpcbiAgICAgICAgICAvL2dldCB2YWx1ZVxuICAgICAgICAgIHJldHVybiBfb3BlcmF0aW9ucy5nZXQoYXJndW1lbnRzKTtcbiAgICAgICAgY2FzZSAnc2V0JzpcbiAgICAgICAgY2FzZSAnaW5wdXQnOlxuICAgICAgICAgIC8vc2V0IHZhbHVlXG4gICAgICAgICAgcmV0dXJuIF9vcGVyYXRpb25zLnNldChhcmd1bWVudHMpO1xuICAgICAgICBjYXNlICdkZWwnOlxuICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICBjYXNlICdybSc6XG4gICAgICAgIGNhc2UgJ3JlbW92ZSc6XG4gICAgICAgICAgLy9yZW1vdmUgdmFsdWVcbiAgICAgICAgICByZXR1cm4gX29wZXJhdGlvbnMuZGVsKGFyZ3VtZW50cyk7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT3BjaVxceEYzbiAnXCIgKyBhcmd1bWVudHNbMF0gKyBcIicgbm8gdlxceEUxbGlkYVwiKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLy9TRVRUSU5HU1xuICAkLmZuLnRva2VuaXplci5kZWZhdWx0cyA9IHtcbiAgICBzZXBhcmF0b3JzOiBbJywnLCAnOyddLFxuICAgIGtleUNvZGVDcmVhdGU6ICQudG9rZW5pemVyLktFWV9DT0RFLkVOVEVSLFxuICAgIHJlcGVhdDogZmFsc2UsXG4gICAgbWF4X2FsbDogMCxcbiAgICBtYXhfaW5wdXQ6IDAsXG4gICAgdGV4dDoge1xuICAgICAgbWF4X2FsbDogJ03DoXhpbW8gYWxjYW56YWRvJ1xuICAgIH0sXG4gICAgb25DbGlja1Rva2VuOiBmdW5jdGlvbiBvbkNsaWNrVG9rZW4oKSB7XG4gICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCd0b2tlbml6ZXItdG9rZW4tYWN0aXZlJyk7XG4gICAgfSxcbiAgICBvbkRlbGV0ZVRva2VuOiBmdW5jdGlvbiBvbkRlbGV0ZVRva2VuKCkge31cbiAgfTtcbn0pOyJdfQ==
